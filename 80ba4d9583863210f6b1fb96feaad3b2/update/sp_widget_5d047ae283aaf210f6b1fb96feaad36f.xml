<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[
function kokoroController($scope, $timeout, $interval, spUtil, $window) {
  var c = this;
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // çŠ¶æ€åˆå§‹åŒ–
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.loading = true;
  c.initialLoadComplete = false;
  c.loadingProgress = 0;
  c.systemOnline = true;
  c.isOffline = !navigator.onLine;
  c.version = 'v3.0.1';
  c.activeTab = 'overview';
  c.sidebarOpen = false;
  c.lastSync = null;
  
  c.user = { id: 'ADM_001', name: 'Administrator', role: 'System Admin' };
  c.mapCenter = { lat: '35.6762', lng: '139.6503' };
  c.mapZoom = 12;
  c.mapWidget = null;
  
  c.tabs = [
    { id: 'overview', label: 'OVERVIEW', code: '01' },
    { id: 'tactical', label: 'TACTICAL', code: '02' },
    { id: 'operations', label: 'OPERATIONS', code: '03' },
    { id: 'logistics', label: 'LOGISTICS', code: '04' }
  ];
  
  c.mapControls = [
    { id: 'sos', label: 'SOS_MARKERS', icon: ']]>ğŸ†˜<![CDATA[', active: true, count: 0 },
    { id: 'shelter', label: 'SHELTER_LOC', icon: ']]>ğŸ <![CDATA[', active: true, count: 0 },
    { id: 'operator', label: 'OPERATOR_POS', icon: ']]>ğŸ‘¤<![CDATA[', active: false, count: 0 },
    { id: 'heatmap', label: 'HEAT_OVERLAY', icon: ']]>ğŸ”¥<![CDATA[', active: false }
  ];
  
  c.data = {
    kpis: [],
    alerts: [],
    inventory: [],
    operations: { queue: [], active: [], completed: 0 },
    system: { status: 'INITIALIZING', uptime: '---', latency: '---', nodes: 0 }
  };
  
  c.weather = { icon: ']]>ğŸŒ¤<![CDATA[', temp: 18, condition: 'Partly Cloudy', humidity: 65, wind: 3.2, pressure: 1013, visibility: 10, forecast: [], warnings: [] };
  c.seismic = { magnitude: 0, location: 'No recent activity', level: 5, status: 'STABLE' };
  c.traffic = { status: 'NORMAL', blockedRoutes: 0 };
  
  c.analytics = { slaHealth: 85, healthTrend: [60, 65, 70, 75, 80, 82, 85], currentHealth: 77.73, activeRequests: 37, volunteerUtil: 0, slaTimers: 0, breachTrend: [5, 8, 3, 6, 4, 7, 2] };
  c.analyticsPeriod = '24h';
  c.completedHistory = [30, 45, 60, 40, 55, 70, 50];
  c.opsFilter = 'all';
  
  c.showKpiModal = false;
  c.showAlertModal = false;
  c.showWeatherPanel = false;
  c.selectedKpi = null;
  c.selectedAlert = null;
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ç¦»çº¿åŠŸèƒ½
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  var CACHE_KEY = 'kokoro_offline_cache';
  
  function saveToCache(data) {
    try {
      localStorage.setItem(CACHE_KEY, JSON.stringify({ timestamp: new Date().toISOString(), data: data }));
    } catch (e) { console.warn('Cache save failed:', e); }
  }
  
  function loadFromCache() {
    try {
      var cached = localStorage.getItem(CACHE_KEY);
      return cached ? JSON.parse(cached) : null;
    } catch (e) { return null; }
  }
  
  c.syncOfflineData = function() {
    if (c.isOffline) { alert('Cannot sync while offline'); return; }
    c.loadData();
  };
  
  $window.addEventListener('online', function() { $scope.$apply(function() { c.isOffline = false; c.loadData(); }); });
  $window.addEventListener('offline', function() { $scope.$apply(function() { c.isOffline = true; }); });
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // å·¥å…·å‡½æ•°
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.getPriorityColor = function(p) { return {1:'#1a1a1a',2:'#404040',3:'#808080',4:'#b0b0b0'}[p] || '#b0b0b0'; };
  c.getPriorityLabel = function(p) { return {1:'CRITICAL',2:'HIGH',3:'MEDIUM',4:'LOW'}[p] || 'LOW'; };
  c.getStatusColor = function(cur, cap) { var r=cur/cap; if(r<0.2)return'#d32f2f'; if(r<0.4)return'#f57c00'; if(r<0.7)return'#808080'; return'#388e3c'; };
  c.getStatusLabel = function(cur, cap) { var r=cur/cap; if(r<0.2)return'CRITICAL'; if(r<0.4)return'LOW'; if(r<0.7)return'NOMINAL'; return'OPTIMAL'; };
  
  function updateTime() {
    var now = new Date();
    c.currentTime = now.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' });
    c.currentDate = now.getFullYear() + '.' + String(now.getMonth()+1).padStart(2,'0') + '.' + String(now.getDate()).padStart(2,'0');
  }
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ä¾§è¾¹æ  & Tab
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.toggleSidebar = function() { c.sidebarOpen = !c.sidebarOpen; };
  
  c.setActiveTab = function(tabId) {
    c.activeTab = tabId;
    if (c.sidebarOpen) c.sidebarOpen = false;
    if (tabId === 'tactical' && !c.mapWidget) c.loadMapWidget();
    if (tabId === 'logistics') c.refreshAnalytics();
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // åœ°å›¾
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.loadMapWidget = function() {
    // ]]>ğŸ”¥<![CDATA[ å°† 'kokoro_live_map' æ›¿æ¢ä¸ºä½ çš„åœ°å›¾ Widget ID
    spUtil.get('kokoro_live_map', {
      showControls: true,
      defaultZoom: c.mapZoom,
      defaultCenter: { lat: parseFloat(c.mapCenter.lat), lng: parseFloat(c.mapCenter.lng) }
    }).then(function(r) {
      c.mapWidget = r;
      c.updateMapLayerCounts();
    }).catch(function(e) { console.error('Map load failed:', e); });
  };
  
  c.toggleMapLayer = function(layerId) {
    var ctrl = c.mapControls.find(function(x) { return x.id === layerId; });
    if (ctrl) {
      ctrl.active = !ctrl.active;
      $scope.$broadcast('mapLayerToggle', { layerId: layerId, active: ctrl.active });
    }
  };
  
  c.updateMapLayerCounts = function() {
    var sos = c.mapControls.find(function(x){return x.id==='sos';}); if(sos) sos.count = c.data.alerts.length;
    var op = c.mapControls.find(function(x){return x.id==='operator';}); 
    if(op) { var k = c.data.kpis.find(function(x){return x.id==='OPR';}); op.count = k ? k.value : 0; }
  };
  
  c.centerMapOnUser = function() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(pos) {
        $scope.$apply(function() {
          c.mapCenter.lat = pos.coords.latitude.toFixed(4);
          c.mapCenter.lng = pos.coords.longitude.toFixed(4);
          $scope.$broadcast('centerMap', c.mapCenter);
        });
      });
    }
  };
  
  c.refreshMapData = function() { $scope.$broadcast('refreshMapData'); c.loadData(); };
  c.createEmergencyMarker = function() { $scope.$broadcast('createEmergencyMarker'); };
  c.createNewRequest = function() { console.log('Create new request'); };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // KPI å¼¹çª—
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.openKpiDetail = function(kpi) {
    c.selectedKpi = angular.copy(kpi);
    c.selectedKpi.history = [];
    for (var i = 0; i < 7; i++) { c.selectedKpi.history.push(Math.floor(kpi.value * (0.7 + Math.random() * 0.6))); }
    
    c.selectedKpi.breakdown = [];
    if (kpi.id === 'REQ') {
      c.selectedKpi.breakdown = [
        { label: 'Food Requests', value: Math.floor(kpi.value * 0.3) },
        { label: 'Medical Requests', value: Math.floor(kpi.value * 0.25) },
        { label: 'Shelter Requests', value: Math.floor(kpi.value * 0.2) },
        { label: 'Water Requests', value: Math.floor(kpi.value * 0.15) },
        { label: 'Other', value: Math.floor(kpi.value * 0.1) }
      ];
    } else if (kpi.id === 'OPR') {
      c.selectedKpi.breakdown = [
        { label: 'Field Operators', value: Math.floor(kpi.value * 0.6) },
        { label: 'Medical Staff', value: Math.floor(kpi.value * 0.2) },
        { label: 'Logistics', value: Math.floor(kpi.value * 0.15) },
        { label: 'Coordinators', value: Math.floor(kpi.value * 0.05) }
      ];
    }
    c.showKpiModal = true;
  };
  
  c.exportKpiData = function() { alert('Exporting data for ' + c.selectedKpi.id); };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Alert å¼¹çª—
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.openAlertDetail = function(alert) {
    c.selectedAlert = angular.copy(alert);
    c.selectedAlert.priorityLabel = c.getPriorityLabel(alert.priority);
    c.showAlertModal = true;
  };
  
  c.handleAlertClick = function(alert) { c.openAlertDetail(alert); };
  c.openAllAlerts = function() { console.log('Open all alerts'); };
  c.assignAlert = function(a) { console.log('Assign:', a.id); };
  c.viewOnMap = function(a) { c.closeModal(); c.setActiveTab('tactical'); $timeout(function() { $scope.$broadcast('highlightLocation', { sector: a.sector, alertId: a.id }); }, 500); };
  c.escalateAlert = function(a) { alert('Escalated: ' + a.id); };
  c.dismissAlert = function(a) { c.closeModal(); };
  c.resolveAlert = function(a) { c.closeModal(); c.loadData(); };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Inventory
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.openInventoryDetail = function(item) { console.log('Inventory detail:', item.id); };
  c.requestRestock = function(item, e) { if(e) e.stopPropagation(); alert('Restock request: ' + item.name); };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Operations
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.createNewTask = function() { console.log('Create task'); };
  c.refreshOperations = function() { c.loadData(); };
  c.applyOpsFilter = function() { console.log('Filter:', c.opsFilter); };
  c.openTaskDetail = function(t) { console.log('Task detail:', t.id); };
  c.assignTask = function(t, e) { if(e) e.stopPropagation(); console.log('Assign:', t.id); };
  c.startTask = function(t, e) { if(e) e.stopPropagation(); console.log('Start:', t.id); };
  c.updateProgress = function(t, e) { if(e) e.stopPropagation(); console.log('Update:', t.id); };
  c.completeTask = function(t, e) { if(e) e.stopPropagation(); console.log('Complete:', t.id); c.loadData(); };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // å¤©æ°”/åœ°éœ‡/äº¤é€š
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.openWeatherPanel = function() { c.loadWeatherData(); c.showWeatherPanel = true; };
  c.openSeismicPanel = function() { console.log('Seismic panel'); };
  c.openTrafficPanel = function() { console.log('Traffic panel'); };
  
  c.loadWeatherData = function() {
    c.weather.forecast = [];
    var icons = [']]>ğŸŒ¤<![CDATA[', 'â˜€ï¸', 'â›…', ']]>ğŸŒ¥<![CDATA[', 'â˜ï¸'];
    for (var i = 0; i < 8; i++) {
      var h = new Date(); h.setHours(h.getHours() + i * 3);
      c.weather.forecast.push({
        time: String(h.getHours()).padStart(2,'0') + ':00',
        icon: icons[Math.floor(Math.random() * icons.length)],
        temp: c.weather.temp + Math.floor(Math.random() * 6) - 3
      });
    }
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ç®¡ç†é¢æ¿
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.openManagementPanel = function(type) { console.log('Management:', type); c.toggleSidebar(); };
  c.openUserProfile = function() { console.log('User profile'); };
  c.openSettings = function() { console.log('Settings'); c.toggleSidebar(); };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Analytics
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.refreshAnalytics = function() {
    c.server.get({ action: 'getAnalytics', period: c.analyticsPeriod }).then(function(r) {
      if (r.data && r.data.analytics) c.analytics = r.data.analytics;
    });
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // å¼¹çª—æ§åˆ¶
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.closeModal = function() {
    c.showKpiModal = false;
    c.showAlertModal = false;
    c.showWeatherPanel = false;
    c.selectedKpi = null;
    c.selectedAlert = null;
  };
  
  document.addEventListener('keydown', function(e) { if (e.keyCode === 27) { $scope.$apply(function() { c.closeModal(); }); } });
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // æ•°æ®åŠ è½½
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.loadData = function() {
    if (!c.initialLoadComplete) c.loading = true;
    c.loadingProgress = 10;
    
    if (c.isOffline) {
      var cached = loadFromCache();
      if (cached) { processData(cached.data); c.lastSync = '(cached)'; c.loading = false; c.initialLoadComplete = true; return; }
    }
    
    c.server.get({ action: 'getData' }).then(function(r) {
      c.loadingProgress = 50;
      if (r.data) { processData(r.data); saveToCache(r.data); c.lastSync = new Date().toLocaleTimeString(); }
      c.loadingProgress = 100;
      $timeout(function() { c.loading = false; c.initialLoadComplete = true; c.systemOnline = true; }, 300);
    }).catch(function(e) {
      var cached = loadFromCache();
      if (cached) { processData(cached.data); c.lastSync = '(cached)'; }
      c.loading = false; c.initialLoadComplete = true; c.systemOnline = false;
    });
  };
  
  function processData(data) {
    if (data.kpis) c.data.kpis = data.kpis.map(function(k) { k.trendDisplay = (k.trend >= 0 ? '+' : '') + k.trend.toFixed(1) + '%'; return k; });
    if (data.alerts) c.data.alerts = data.alerts.map(function(a) { a.priorityLabel = c.getPriorityLabel(a.priority); return a; });
    if (data.inventory) c.data.inventory = data.inventory.map(function(i) { i.percentage = Math.round((i.current / i.capacity) * 100); i.statusColor = c.getStatusColor(i.current, i.capacity); i.statusLabel = c.getStatusLabel(i.current, i.capacity); return i; });
    if (data.operations) c.data.operations = data.operations;
    if (data.system) c.data.system = data.system;
    c.updateMapLayerCounts();
  }
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Sniper Protocol (æ¸…ç†åŸç”Ÿç»„ä»¶)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  function runSniper() {
    try {
      var els = document.body.children;
      for (var i = 0; i < els.length; i++) {
        var el = els[i];
        if (el.tagName === 'SCRIPT' || el.tagName === 'STYLE' || el.tagName === 'LINK') continue;
        var isFriend = el.classList && (el.classList.contains('kokoro-zenless') || el.classList.contains('modal'));
        if (!isFriend && el.querySelector) isFriend = !!el.querySelector('.kokoro-zenless');
        if (isFriend) continue;
        var isNav = el.tagName === 'HEADER' || el.tagName === 'NAV' || (el.classList && el.classList.contains('sp-page-header'));
        if (isNav) { el.style.setProperty('display', 'none', 'important'); el.style.setProperty('visibility', 'hidden', 'important'); }
      }
    } catch (e) {}
  }
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // åˆå§‹åŒ– & æ¸…ç†
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  var refreshInterval, timeInterval, sniperInterval;
  
  c.$onInit = function() {
    console.log('KOKORO Command Center v3.0 initializing...');
    updateTime();
    timeInterval = $interval(updateTime, 1000);
    c.loadData();
    refreshInterval = $interval(function() { if (!c.isOffline) c.loadData(); }, 30000);
    $timeout(runSniper, 0);
    sniperInterval = $interval(runSniper, 500);
    $timeout(function() { $interval.cancel(sniperInterval); sniperInterval = $interval(runSniper, 3000); }, 10000);
    console.log('KOKORO initialized');
  };
  
  $scope.$on('$destroy', function() {
    if (refreshInterval) $interval.cancel(refreshInterval);
    if (timeInterval) $interval.cancel(timeInterval);
    if (sniperInterval) $interval.cancel(sniperInterval);
  });
}]]></client_script>
        <controller_as>c</controller_as>
        <css>// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DESIGN TOKENS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

$bg-base: #fafafa;
$bg-elevated: #ffffff;
$bg-subtle: #f0f0f0;
$bg-muted: #f8f8f8;

$border-light: #e8e8e8;
$border-default: #e0e0e0;
$border-strong: #d0d0d0;

$text-primary: #1a1a1a;
$text-secondary: #404040;
$text-tertiary: #808080;
$text-muted: #a0a0a0;
$text-disabled: #c0c0c0;

$priority-critical: #1a1a1a;
$priority-high: #404040;
$priority-medium: #808080;
$priority-low: #b0b0b0;

$accent-danger: #d32f2f;
$accent-warning: #f57c00;
$accent-success: #388e3c;
$accent-info: #1976d2;

$font-ui: 'Inter', -apple-system, sans-serif;
$font-mono: 'Space Mono', 'JetBrains Mono', monospace;

$space-xs: 4px;
$space-sm: 8px;
$space-md: 16px;
$space-lg: 24px;
$space-xl: 32px;

$sidebar-width: 280px;
$header-height: 72px;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ANIMATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideInLeft {
  from { transform: translateX(-100%); }
  to { transform: translateX(0); }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

@keyframes equalizer {
  0% { height: 4px; opacity: 0.4; }
  50% { height: 10px; opacity: 0.8; }
  100% { height: 4px; opacity: 0.4; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BASE CONTAINER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kokoro-zenless {
  // å¿…é¡»åŠ ä¸Šè¿™å‡ è¡Œæ¥æ¥ç®¡ä» HTML &lt;style&gt; ä¼ é€’è¿‡æ¥çš„å…¨å±æ§åˆ¶
  position: fixed !important;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1000;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  background: $bg-base;
  z-index: 1000;
  
  * {
    box-sizing: border-box;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OFFLINE BANNER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.offline-banner {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 32px;
  background: $accent-warning;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $space-sm;
  font-size: 12px;
  font-weight: 600;
  z-index: 3000;
  
  .offline-icon { font-size: 14px; }
}

.offline-mode {
  .kz-header { margin-top: 32px; }
  .kz-sidebar { top: 32px; height: calc(100vh - 32px); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BACKGROUND LAYERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.noise-layer {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  opacity: 0.02;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0;
}

.grid-layer {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-image: 
    linear-gradient(rgba(0,0,0,0.02) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,0.02) 1px, transparent 1px);
  background-size: 48px 48px;
  pointer-events: none;
  z-index: 0;
}

.corner-bracket {
  position: fixed;
  width: 24px; height: 24px;
  border-left: 2px solid $border-strong;
  border-top: 2px solid $border-strong;
  z-index: 100;
  pointer-events: none;
  
  &amp;.corner-tl { top: 12px; left: 12px; }
  &amp;.corner-tr { top: 12px; right: 12px; transform: rotate(90deg); }
  &amp;.corner-bl { bottom: 12px; left: 12px; transform: rotate(-90deg); }
  &amp;.corner-br { bottom: 12px; right: 12px; transform: rotate(180deg); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIDEBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-sidebar {
  position: fixed;
  top: 0; left: 0;
  width: $sidebar-width;
  height: 100vh;
  background: $bg-elevated;
  border-right: 1px solid $border-default;
  transform: translateX(-100%);
  transition: transform 0.3s ease;
  z-index: 2500;
  display: flex;
  flex-direction: column;
  
  &amp;.open { transform: translateX(0); }
}

.sidebar-header {
  display: flex;
  align-items: center;
  gap: $space-md;
  padding: $space-lg;
  border-bottom: 1px solid $border-default;
  
  .sidebar-logo {
    width: 36px; height: 36px;
    background: $text-primary;
    display: flex;
    align-items: center;
    justify-content: center;
    clip-path: polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 100%, 6px 100%, 0 calc(100% - 6px));
    
    .logo-letter {
      color: $bg-base;
      font-size: 16px;
      font-weight: 700;
      font-family: $font-mono;
    }
  }
  
  .sidebar-title {
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 2px;
    flex: 1;
  }
  
  .sidebar-close {
    width: 32px; height: 32px;
    background: transparent;
    border: 1px solid $border-default;
    color: $text-tertiary;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.15s;
    
    &amp;:hover {
      background: $bg-subtle;
      color: $text-primary;
    }
  }
}

.sidebar-nav {
  flex: 1;
  overflow-y: auto;
  padding: $space-md 0;
}

.sidebar-section {
  padding: 0 $space-md;
  margin-bottom: $space-lg;
}

.sidebar-section-title {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 1px;
  color: $text-muted;
  padding: $space-sm $space-md;
  font-family: $font-mono;
}

.sidebar-item {
  display: flex;
  align-items: center;
  gap: $space-md;
  width: 100%;
  padding: 12px $space-md;
  background: transparent;
  border: none;
  color: $text-secondary;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.15s;
  text-align: left;
  
  &amp;:hover {
    background: $bg-subtle;
    color: $text-primary;
  }
  
  .sidebar-icon {
    font-size: 16px;
    width: 24px;
    text-align: center;
  }
}

.sidebar-footer {
  padding: $space-lg;
  border-top: 1px solid $border-default;
}

.sidebar-user {
  display: flex;
  align-items: center;
  gap: $space-md;
  
  .user-avatar {
    width: 40px; height: 40px;
    background: $text-primary;
    color: $bg-base;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: 600;
    border-radius: 2px;
  }
  
  .user-name { font-size: 13px; font-weight: 600; }
  .user-role { font-size: 11px; color: $text-tertiary; }
}

.sidebar-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.3);
  z-index: 2400;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HEADER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  height: $header-height;
  padding: 0 $space-xl;
  background: linear-gradient(180deg, $bg-elevated 0%, $bg-subtle 100%);
  border-bottom: 1px solid $border-default;
  flex-shrink: 0;
  z-index: 100;
  gap: $space-lg;
}

.header-left {
  display: flex;
  align-items: center;
  gap: $space-lg;
  flex-shrink: 0;
}

.hamburger-btn {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 5px;
  width: 40px; height: 40px;
  background: transparent;
  border: 1px solid $border-default;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover {
    background: $bg-subtle;
    border-color: $border-strong;
  }
  
  .hamburger-line {
    width: 18px; height: 2px;
    background: $text-primary;
  }
}

.logo-group {
  display: flex;
  align-items: center;
  gap: 12px;
}

.logo-mark {
  width: 40px; height: 40px;
  background: $text-primary;
  display: flex;
  align-items: center;
  justify-content: center;
  clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
  
  .logo-letter {
    color: $bg-base;
    font-size: 18px;
    font-weight: 700;
    font-family: $font-mono;
  }
}

.logo-text {
  .logo-title {
    font-size: 16px;
    font-weight: 700;
    letter-spacing: 3px;
  }
  .logo-subtitle {
    font-size: 9px;
    letter-spacing: 1px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
}

.system-badge {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: 6px 12px;
  background: $bg-subtle;
  border: 1px solid $border-default;
  
  .status-dot {
    width: 6px; height: 6px;
    background: $text-muted;
    border-radius: 1px;
  }
  
  &amp;.online .status-dot {
    background: $accent-success;
    animation: pulse 2s infinite;
  }
  
  &amp;.offline .status-dot {
    background: $accent-warning;
  }
  
  .status-text {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 1px;
    font-family: $font-mono;
  }
  
  .version-text {
    font-size: 9px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
}

.kz-nav {
  display: flex;
  gap: 4px;
  flex: 1;
  justify-content: center;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 10px 16px;
  background: transparent;
  border: 1px solid transparent;
  color: $text-tertiary;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 1px;
  cursor: pointer;
  font-family: $font-mono;
  transition: all 0.15s;
  
  &amp;:hover {
    color: $text-secondary;
    background: $bg-subtle;
  }
  
  &amp;.active {
    background: $text-primary;
    color: $bg-base;
    border-color: $text-primary;
  }
  
  .nav-code { opacity: 0.6; }
  .nav-divider { opacity: 0.3; }
}

.header-right {
  display: flex;
  align-items: center;
  gap: $space-lg;
  flex-shrink: 0;
}

.weather-mini {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: 6px 12px;
  background: $bg-subtle;
  border: 1px solid $border-default;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover { border-color: $border-strong; }
  .weather-icon { font-size: 16px; }
  .weather-temp { font-size: 12px; font-weight: 600; font-family: $font-mono; }
}

.time-display, .date-display {
  text-align: right;
  
  [class$="-label"] {
    font-size: 8px;
    letter-spacing: 1px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
}

.time-display .time-value {
  font-size: 18px;
  font-weight: 700;
  font-family: $font-mono;
  letter-spacing: 2px;
}

.date-display .date-value {
  font-size: 11px;
  font-family: $font-mono;
  color: $text-secondary;
}

.operator-badge {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: $space-sm 14px;
  background: $bg-subtle;
  border: 1px solid $border-default;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover { border-color: $border-strong; }
  .operator-icon { font-size: 14px; }
  .operator-label { font-size: 8px; letter-spacing: 1px; color: $text-tertiary; font-family: $font-mono; }
  .operator-id { font-size: 11px; font-weight: 600; font-family: $font-mono; }
}

.header-rule {
  display: flex;
  align-items: center;
  padding: 0 $space-xl;
  background: $bg-subtle;
  height: 24px;
  flex-shrink: 0;
  
  .rule-left, .rule-right { flex: 1; height: 1px; }
  .rule-left { background: linear-gradient(90deg, transparent, $border-strong); }
  .rule-right { background: linear-gradient(90deg, $border-strong, transparent); }
  
  .rule-center {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 0 $space-md;
    font-size: 8px;
    color: $text-muted;
    letter-spacing: 2px;
    font-family: $font-mono;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAIN CONTENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-main {
  flex: 1;
  padding: $space-lg $space-xl;
  overflow-y: auto;
  position: relative;
  z-index: 10;
}

.tab-panel { animation: fadeIn 0.3s ease; }

.section-block { margin-bottom: $space-lg; }

.section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: $space-md;
}

.section-tag {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: 4px 10px;
  background: $text-primary;
  color: $bg-base;
  
  .tag-code { font-size: 9px; font-family: $font-mono; opacity: 0.6; }
  .tag-label { font-size: 10px; font-weight: 600; letter-spacing: 1px; font-family: $font-mono; }
}

.section-rule { flex: 1; height: 1px; background: $border-default; }
.section-time { font-size: 10px; color: $text-tertiary; font-family: $font-mono; }

.section-action {
  background: transparent;
  border: 1px solid $border-default;
  padding: 4px 12px;
  font-size: 10px;
  font-family: $font-mono;
  color: $text-tertiary;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover { background: $bg-subtle; color: $text-primary; }
}

.alert-count {
  font-size: 10px;
  font-weight: 700;
  padding: 2px $space-sm;
  background: $text-primary;
  color: $bg-base;
  font-family: $font-mono;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KPI CARDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kpi-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: $space-md;
}

.kpi-card {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
  position: relative;
  overflow: hidden;
  transition: all 0.2s;
  
  &amp;.clickable {
    cursor: pointer;
    
    &amp;:hover {
      border-color: $text-primary;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transform: translateY(-2px);
      
      .click-hint { opacity: 1; }
    }
  }
}

.click-hint {
  position: absolute;
  top: $space-sm;
  right: $space-sm;
  font-size: 8px;
  color: $text-muted;
  font-family: $font-mono;
  opacity: 0;
  transition: opacity 0.2s;
}

.chamfer-tr {
  position: absolute;
  top: 0; right: 0;
  width: 16px; height: 16px;
  background: $bg-base;
  clip-path: polygon(0 0, 100% 100%, 100% 0);
}

.chamfer-bl {
  position: absolute;
  bottom: 0; left: 0;
  width: 16px; height: 16px;
  background: $bg-base;
  clip-path: polygon(0 0, 0 100%, 100% 100%);
}

.kpi-header {
  display: flex;
  align-items: baseline;
  margin-bottom: $space-md;
  
  .kpi-id { font-size: 11px; font-weight: 700; letter-spacing: 1px; font-family: $font-mono; }
  .kpi-index { font-size: 9px; color: $text-muted; font-family: $font-mono; }
}

.kpi-body {
  display: flex;
  align-items: baseline;
  margin-bottom: $space-sm;
  
  .kpi-value { font-size: 42px; font-weight: 700; line-height: 1; letter-spacing: -1px; }
  .kpi-unit { font-size: 14px; font-weight: 500; color: $text-tertiary; margin-left: 4px; }
}

.kpi-label {
  font-size: 10px;
  letter-spacing: 1px;
  color: $text-tertiary;
  font-family: $font-mono;
  margin-bottom: 12px;
}

.kpi-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  .kpi-trend {
    font-size: 11px;
    font-weight: 600;
    font-family: $font-mono;
    
    &amp;.trend-up { color: $accent-success; }
    &amp;.trend-down { color: $accent-danger; }
  }
  
  .kpi-status { font-size: 9px; color: $text-muted; font-family: $font-mono; }
}

// è¦†ç›–ä¿®å¤ï¼šç¡®ä¿ KPI æ­£å¸¸é—­åˆï¼Œä¸” Realtime æ ·å¼ç”Ÿæ•ˆ

.barcode-deco {
  position: absolute;
  bottom: 12px;
  right: 12px;
  display: flex;
  gap: 2px;
  align-items: flex-end;
  height: 16px;
  
  .bar {
    display: inline-block;
    width: 2px;
    height: 6px;
    background: #b0b0b0;
    opacity: 0.5;
    animation: equalizer 2s infinite ease-in-out;
    
    // ç®€å•å¾ªç¯ï¼Œé¿å…å¤æ‚åµŒå¥—å‡ºé”™
    &amp;:nth-child(odd) { height: 8px; }
    &amp;:nth-child(even) { height: 4px; }
  }
} 
// â†‘â†‘â†‘ æ£€æŸ¥è¿™é‡Œï¼ä½ ä¹‹å‰å¯èƒ½å°‘äº†è¿™ä¸ªé—­åˆæ‹¬å·ï¼Œå¯¼è‡´ä¸‹é¢çš„æ ·å¼å˜æˆäº† .barcode-deco çš„å­å…ƒç´ 

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REAL-TIME MONITOR (ä¿®å¤ç‰ˆ)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.realtime-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px; // ä½¿ç”¨å›ºå®šå€¼é¿å…å˜é‡å¤±æ•ˆ
  margin-top: 16px;
}

.realtime-card {
  background: #ffffff; // é¿å…å˜é‡ $bg-elevated å¤±æ•ˆ
  border: 1px solid #e0e0e0;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 16px;
  cursor: pointer;
  transition: all 0.2s;
  
  &amp;:hover {
    border-color: #1a1a1a;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }
  
  .realtime-icon { font-size: 28px; }
  .realtime-content { flex: 1; }
  .realtime-title { font-size: 9px; letter-spacing: 1px; color: #808080; font-family: monospace; }
  .realtime-value { font-size: 18px; font-weight: 700; color: #1a1a1a; }
  .realtime-sub { font-size: 11px; color: #808080; }
  
  .realtime-extra {
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-size: 10px;
    color: #808080;
    font-family: monospace;
  }
}
  
  .realtime-status {
    font-size: 9px;
    font-weight: 600;
    padding: 4px 8px;
    background: $bg-subtle;
    font-family: $font-mono;
    
    &amp;.level-1, &amp;.level-2 { background: rgba($accent-danger, 0.1); color: $accent-danger; }
    &amp;.level-3 { background: rgba($accent-warning, 0.1); color: $accent-warning; }
    &amp;.level-4, &amp;.level-5 { background: rgba($accent-success, 0.1); color: $accent-success; }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ALERTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-alerts {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
}

.alerts-list {
  display: flex;
  flex-direction: column;
  gap: $space-sm;
  max-height: 280px;
  overflow-y: auto;
  
  &amp;::-webkit-scrollbar { width: 4px; }
  &amp;::-webkit-scrollbar-thumb { background: $border-strong; }
  &amp;::-webkit-scrollbar-track { background: $bg-subtle; }
}

.alert-card {
  display: flex;
  align-items: stretch;
  background: $bg-muted;
  border: 1px solid $border-light;
  overflow: hidden;
  transition: all 0.15s;
  
  &amp;.clickable {
    cursor: pointer;
    
    &amp;:hover {
      background: $bg-subtle;
      border-color: $border-default;
      transform: translateX(4px);
      
      .alert-action {
        background: $text-primary;
        color: $bg-base;
      }
    }
  }
}

.alert-priority-bar {
  width: 4px;
  flex-shrink: 0;
  
  .priority-1 &amp; { background: $priority-critical; }
  .priority-2 &amp; { background: $priority-high; }
  .priority-3 &amp; { background: $priority-medium; }
  .priority-4 &amp; { background: $priority-low; }
}

.alert-content {
  flex: 1;
  padding: 12px $space-md;
}

.alert-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 6px;
  flex-wrap: wrap;
  
  .alert-id { font-size: 10px; font-weight: 600; font-family: $font-mono; }
  
  .alert-priority-label {
    font-size: 9px;
    font-weight: 700;
    font-family: $font-mono;
    
    .priority-1 &amp; { color: $priority-critical; }
    .priority-2 &amp; { color: $priority-high; }
    .priority-3 &amp; { color: $priority-medium; }
    .priority-4 &amp; { color: $priority-low; }
  }
  
  .alert-sector {
    font-size: 9px;
    color: $text-tertiary;
    padding: 2px 6px;
    background: $bg-elevated;
    border: 1px solid $border-default;
    font-family: $font-mono;
  }
  
  .alert-elapsed {
    font-size: 10px;
    color: $text-muted;
    font-family: $font-mono;
    margin-left: auto;
  }
}

.alert-message {
  font-size: 12px;
  color: $text-secondary;
  line-height: 1.4;
}

.alert-action {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  background: $bg-subtle;
  color: $text-tertiary;
  font-size: 16px;
  transition: all 0.15s;
}

.alerts-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $space-sm;
  padding: $space-xl;
  color: $text-tertiary;
  
  .empty-icon { color: $accent-success; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INVENTORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-inventory {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
}

.inventory-list {
  display: flex;
  flex-direction: column;
  gap: $space-md;
}

.inventory-item {
  transition: all 0.15s;
  
  &amp;.clickable {
    cursor: pointer;
    padding: $space-sm;
    margin: -$space-sm;
    
    &amp;:hover { background: $bg-subtle; }
  }
  
  .inventory-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: $space-sm;
    
    .inventory-id { font-size: 9px; font-family: $font-mono; color: $text-tertiary; }
    .inventory-name { font-size: 12px; font-weight: 500; flex: 1; }
    .inventory-pct { font-size: 11px; font-weight: 700; font-family: $font-mono; }
  }
}

.inventory-bar-outer {
  height: 6px;
  background: $border-light;
  position: relative;
  margin-bottom: 6px;
}

.inventory-bar-inner {
  height: 100%;
  transition: width 0.3s ease;
}

.scale-marker {
  position: absolute;
  top: 0; bottom: 0;
  width: 1px;
  background: $border-strong;
}

.inventory-values {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  font-family: $font-mono;
  
  .inv-sep { color: $text-disabled; }
  .inv-capacity { color: $text-muted; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SYSTEM STATUS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-system {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
}

.system-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: $space-md;
}

.system-stat {
  text-align: center;
  padding: 20px;
  background: $bg-muted;
  border: 1px solid $border-light;
  
  .stat-label {
    font-size: 9px;
    letter-spacing: 2px;
    color: $text-tertiary;
    margin-bottom: $space-sm;
    font-family: $font-mono;
  }
  
  .stat-value {
    font-size: 20px;
    font-weight: 700;
    font-family: $font-mono;
    
    &amp;.highlight { color: $accent-success; }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TACTICAL MAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.tab-tactical {
  height: calc(100vh - 160px);
  position: relative;
  display: flex;
}

.map-controls {
  position: absolute;
  top: $space-lg;
  left: $space-lg;
  z-index: 20;
  background: rgba($bg-elevated, 0.95);
  border: 1px solid $border-default;
  min-width: 180px;
  
  .map-controls-header {
    padding: $space-sm $space-md;
    border-bottom: 1px solid $border-light;
    
    .controls-title {
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 1px;
      font-family: $font-mono;
    }
  }
  
  .map-controls-divider {
    height: 1px;
    background: $border-light;
    margin: $space-sm 0;
  }
}

.map-ctrl-btn {
  display: flex;
  align-items: center;
  gap: $space-sm;
  width: 100%;
  padding: 10px $space-md;
  background: transparent;
  border: none;
  color: $text-tertiary;
  font-size: 10px;
  font-family: $font-mono;
  cursor: pointer;
  transition: all 0.15s;
  text-align: left;
  
  &amp;:hover {
    background: $bg-subtle;
    color: $text-primary;
  }
  
  &amp;.active {
    background: $text-primary;
    color: $bg-base;
  }
  
  .ctrl-icon { font-size: 14px; width: 20px; text-align: center; }
  .ctrl-count { margin-left: auto; opacity: 0.6; }
}

.map-wrapper {
  flex: 1;
  background: $bg-subtle;
  border: 1px solid $border-default;
  position: relative;
  
  sp-widget, sp-widget &gt; div {
    display: block;
    width: 100%;
    height: 100%;
  }
}

.map-loading {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  
  .map-loading-spinner {
    width: 40px; height: 40px;
    border: 2px solid $border-default;
    border-top-color: $text-primary;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto $space-md;
  }
  
  .map-loading-text {
    font-size: 11px;
    letter-spacing: 2px;
    font-family: $font-mono;
    color: $text-tertiary;
  }
}

.map-overlay-info {
  position: absolute;
  bottom: $space-lg;
  left: 50%;
  transform: translateX(-50%);
  z-index: 20;
  
  .coord-display {
    display: flex;
    gap: $space-md;
    padding: $space-sm $space-md;
    background: rgba($bg-elevated, 0.95);
    border: 1px solid $border-default;
    font-size: 10px;
    font-family: $font-mono;
    
    .coord-sep { color: $text-disabled; }
  }
}

.map-quick-actions {
  position: absolute;
  bottom: $space-lg;
  right: $space-lg;
  z-index: 20;
  display: flex;
  flex-direction: column;
  gap: $space-sm;
}

.quick-action-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 56px; height: 56px;
  background: $bg-elevated;
  border: 1px solid $border-default;
  cursor: pointer;
  transition: all 0.15s;
  font-size: 18px;
  
  &amp;:hover {
    background: $bg-subtle;
    border-color: $border-strong;
  }
  
  &amp;.emergency {
    background: $accent-danger;
    border-color: $accent-danger;
    color: white;
    
    &amp;:hover { background: darken($accent-danger, 10%); }
  }
  
  span:last-child {
    font-size: 8px;
    letter-spacing: 1px;
    font-family: $font-mono;
    margin-top: 2px;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OPERATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.tab-operations {
  height: calc(100vh - 160px);
  display: flex;
  flex-direction: column;
}

.ops-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: $space-md;
  padding: $space-sm 0;
}

.ops-toolbar-left {
  display: flex;
  gap: $space-sm;
}

.toolbar-btn {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: $space-sm $space-md;
  background: $bg-elevated;
  border: 1px solid $border-default;
  font-size: 11px;
  font-family: $font-mono;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover {
    background: $bg-subtle;
    border-color: $border-strong;
  }
}

.ops-filter {
  display: flex;
  align-items: center;
  gap: $space-sm;
  
  label {
    font-size: 10px;
    font-family: $font-mono;
    color: $text-tertiary;
  }
  
  select {
    padding: $space-sm $space-md;
    border: 1px solid $border-default;
    background: $bg-elevated;
    font-size: 11px;
    font-family: $font-mono;
  }
}

.ops-board {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: $space-md;
  min-height: 0;
}

.ops-column {
  background: $bg-elevated;
  border: 1px solid $border-default;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.ops-column-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: $space-md;
  border-bottom: 1px solid $border-default;
  
  .ops-column-tag {
    display: flex;
    align-items: center;
    gap: $space-sm;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 1px;
    font-family: $font-mono;
    
    .tag-icon { font-size: 14px; }
  }
  
  .ops-column-count {
    font-size: 10px;
    padding: 2px $space-sm;
    background: $bg-subtle;
    font-family: $font-mono;
  }
}

.ops-column-list {
  flex: 1;
  padding: $space-md;
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-y: auto;
}

.op-card {
  background: $bg-muted;
  border: 1px solid $border-light;
  padding: $space-md;
  transition: all 0.15s;
  
  &amp;.clickable {
    cursor: pointer;
    
    &amp;:hover {
      border-color: $border-default;
      background: $bg-subtle;
    }
  }
}

.op-card-header {
  display: flex;
  align-items: center;
  gap: $space-sm;
  margin-bottom: $space-sm;
  
  .op-priority-dot { width: 8px; height: 8px; border-radius: 1px; }
  .op-id { font-size: 10px; font-family: $font-mono; color: $text-tertiary; }
  
  .op-priority-badge {
    margin-left: auto;
    font-size: 9px;
    font-weight: 600;
    padding: 2px 6px;
    background: $bg-elevated;
    border: 1px solid $border-default;
    font-family: $font-mono;
  }
}

.op-title {
  font-size: 13px;
  font-weight: 500;
  margin-bottom: $space-sm;
  line-height: 1.3;
}

.op-meta {
  display: flex;
  gap: $space-md;
  font-size: 10px;
  color: $text-muted;
  font-family: $font-mono;
  margin-bottom: $space-sm;
  
  .meta-icon { margin-right: 4px; }
}

.op-operator {
  display: flex;
  align-items: center;
  gap: $space-sm;
  margin-bottom: 12px;
  font-size: 11px;
  
  .op-operator-icon { color: $text-primary; }
}

.op-progress {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: $space-sm;
}

.op-progress-bar {
  flex: 1;
  height: 4px;
  background: $border-default;
}

.op-progress-fill {
  height: 100%;
  background: $text-primary;
  transition: width 0.3s ease;
}

.op-progress-value {
  font-size: 11px;
  font-weight: 600;
  font-family: $font-mono;
  min-width: 35px;
}

.op-actions {
  display: flex;
  gap: $space-xs;
  margin-top: $space-sm;
  padding-top: $space-sm;
  border-top: 1px solid $border-light;
}

.op-action-btn {
  flex: 1;
  padding: $space-xs $space-sm;
  background: $bg-elevated;
  border: 1px solid $border-default;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover {
    background: $bg-subtle;
    border-color: $border-strong;
  }
}

.ops-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: $space-xl;
  color: $text-muted;
  font-size: 12px;
}

.ops-completed-display {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: $space-lg;
  
  .completed-value { font-size: 64px; font-weight: 700; line-height: 1; }
  .completed-label { font-size: 11px; letter-spacing: 2px; color: $text-tertiary; margin-top: $space-md; font-family: $font-mono; }
  .completed-period { font-size: 10px; color: $text-muted; margin-top: $space-sm; font-family: $font-mono; }
  .completed-chart { margin-top: $space-lg; width: 100%; }
}

.mini-chart {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 4px;
  height: 40px;
  
  .chart-bar {
    width: 8px;
    background: $border-default;
    transition: height 0.3s ease;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOGISTICS &amp; ANALYTICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-analytics { margin-bottom: $space-xl; }

.analytics-period {
  select {
    padding: 4px $space-sm;
    border: 1px solid $border-default;
    background: $bg-elevated;
    font-size: 10px;
    font-family: $font-mono;
  }
}

.analytics-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: $space-md;
}

.analytics-card {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: $space-md;
  
  &amp;.highlight {
    border-color: $text-primary;
    border-width: 2px;
  }
}

.analytics-card-header {
  margin-bottom: $space-md;
  
  .analytics-title {
    font-size: 11px;
    font-weight: 500;
    color: $text-secondary;
  }
}

// ä¿®å¤ SVG å·¨å¤§åŒ– (åˆå¹¶åçš„æ­£ç¡®ä»£ç )
.analytics-gauge {
  position: relative;
  height: 80px;
  width: 100%;
  
  // åˆšæ‰å˜ç»¿çš„å±æ€§ï¼Œå¿…é¡»æ”¾åœ¨å¤§æ‹¬å·é‡Œé¢
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden; // é˜²æ­¢æº¢å‡º

  // SVG é™åˆ¶è§„åˆ™
  svg {
    position: absolute;
    // âš ï¸ å…³é”®ï¼šä½¿ç”¨ !important å¼ºåˆ¶è¦†ç›–é»˜è®¤çš„ 100% å®½åº¦
    width: auto !important; 
    height: 100% !important; 
    max-width: 100%;
  }
}
  
  .gauge-value {
    font-size: 24px;
    font-weight: 700;
    font-family: $font-mono;
    margin-top: 20px;
  }
}

.analytics-big-number {
  font-size: 48px;
  font-weight: 700;
  text-align: center;
  padding: $space-md 0;
}

.analytics-chart { height: 80px; }

.trend-chart {
  position: relative;
  height: 100%;
  
  .trend-line {
    position: relative;
    height: 60px;
    border-bottom: 1px solid $border-light;
  }
  
  .trend-point {
    position: absolute;
    width: 6px; height: 6px;
    background: $text-primary;
    border-radius: 50%;
  }
  
  .trend-value {
    position: absolute;
    right: 0; bottom: 0;
    font-size: 18px;
    font-weight: 700;
    font-family: $font-mono;
  }
}

.analytics-mini-chart { height: 60px; }

.breach-chart {
  display: flex;
  align-items: flex-end;
  gap: 4px;
  height: 100%;
  
  .breach-bar {
    flex: 1;
    background: $border-default;
    min-height: 4px;
  }
}

.logistics-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: $space-md;
}

.logistics-card {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: $space-lg;
  text-align: center;
  position: relative;
  transition: all 0.2s;
  
  &amp;.clickable {
    cursor: pointer;
    
    &amp;:hover {
      border-color: $text-primary;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
  }
}

.logistics-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: $space-sm;
  
  .logistics-id { font-size: 10px; font-weight: 600; font-family: $font-mono; }
  .logistics-status { font-size: 9px; font-weight: 700; font-family: $font-mono; }
}

.logistics-name {
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 20px;
}

.logistics-gauge {
  position: relative;
  width: 100px; height: 100px;
  margin: 0 auto $space-md;
  
  .gauge-ring { width: 100%; height: 100%; }
  .gauge-bg { fill: none; stroke: $border-light; stroke-width: 6; }
  .gauge-fill { fill: none; stroke-width: 6; stroke-linecap: square; transition: stroke-dasharray 0.5s ease; }
  
  .gauge-value {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-size: 22px;
    font-weight: 700;
    font-family: $font-mono;
  }
}

.logistics-values {
  font-size: 12px;
  font-family: $font-mono;
  margin-bottom: $space-md;
  
  .lg-current { font-weight: 600; }
  .lg-divider { color: $text-disabled; margin: 0 4px; }
  .lg-capacity { color: $text-muted; }
}

.logistics-actions {
  .lg-action-btn {
    width: 100%;
    padding: $space-sm;
    background: $bg-subtle;
    border: 1px solid $border-default;
    font-size: 10px;
    font-family: $font-mono;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.15s;
    
    &amp;:hover {
      background: $text-primary;
      color: $bg-base;
      border-color: $text-primary;
    }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FOOTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px $space-xl;
  background: $bg-subtle;
  border-top: 1px solid $border-default;
  font-size: 10px;
  font-family: $font-mono;
  color: $text-tertiary;
  letter-spacing: 1px;
  flex-shrink: 0;
}

.footer-left, .footer-center, .footer-right {
  display: flex;
  align-items: center;
  gap: 12px;
}

.footer-indicator {
  width: 6px; height: 6px;
  background: $accent-success;
  border-radius: 1px;
  
  &amp;.offline { background: $accent-warning; }
}

.footer-sep { color: $text-disabled; }
.footer-dot { color: $text-disabled; font-size: 6px; }
.footer-muted { color: $text-muted; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODALS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.modal-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 3000;
  animation: fadeIn 0.2s ease;
}

.modal-panel {
  background: $bg-elevated;
  border: 1px solid $border-default;
  width: 480px;
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  animation: fadeIn 0.3s ease;
  
  &amp;.wide { width: 640px; }
}

.modal-header {
  display: flex;
  align-items: center;
  gap: $space-md;
  padding: $space-md $space-lg;
  border-bottom: 1px solid $border-default;
  
  .modal-title {
    flex: 1;
    font-size: 14px;
    font-weight: 600;
    font-family: $font-mono;
  }
  
  .priority-badge {
    font-size: 10px;
    font-weight: 700;
    padding: 4px 8px;
    background: $text-primary;
    color: $bg-base;
    font-family: $font-mono;
  }
  
  .modal-close {
    width: 32px; height: 32px;
    background: transparent;
    border: 1px solid $border-default;
    cursor: pointer;
    font-size: 14px;
    color: $text-tertiary;
    transition: all 0.15s;
    
    &amp;:hover { background: $bg-subtle; color: $text-primary; }
  }
  
  &amp;.priority-1 { border-left: 4px solid $priority-critical; }
  &amp;.priority-2 { border-left: 4px solid $priority-high; }
  &amp;.priority-3 { border-left: 4px solid $priority-medium; }
  &amp;.priority-4 { border-left: 4px solid $priority-low; }
}

.modal-body {
  flex: 1;
  padding: $space-lg;
  overflow-y: auto;
}

.modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: $space-sm;
  padding: $space-md $space-lg;
  border-top: 1px solid $border-default;
}

.modal-btn {
  padding: $space-sm $space-lg;
  background: $bg-subtle;
  border: 1px solid $border-default;
  font-size: 11px;
  font-family: $font-mono;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.15s;
  
  &amp;:hover { background: $bg-muted; }
  
  &amp;.primary {
    background: $text-primary;
    color: $bg-base;
    border-color: $text-primary;
  }
  
  &amp;.danger {
    background: $accent-danger;
    color: white;
    border-color: $accent-danger;
  }
}

// KPI Detail
.kpi-detail-value {
  text-align: center;
  margin-bottom: $space-lg;
  
  .big-value { font-size: 64px; font-weight: 700; }
  .big-unit { font-size: 24px; color: $text-tertiary; margin-left: $space-sm; }
}

.kpi-detail-trend {
  text-align: center;
  margin-bottom: $space-lg;
  
  .positive { color: $accent-success; font-weight: 600; }
  .negative { color: $accent-danger; font-weight: 600; }
  .trend-label { font-size: 11px; color: $text-muted; margin-left: $space-sm; }
}

.kpi-detail-chart {
  margin-bottom: $space-lg;
  padding: $space-md;
  background: $bg-subtle;
  border: 1px solid $border-light;
}

.detail-chart-container {
  display: flex;
  align-items: flex-end;
  justify-content: space-around;
  height: 100px;
  
  .chart-bar {
    width: 24px;
    background: $text-primary;
    position: relative;
    
    .chart-label {
      position: absolute;
      bottom: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 9px;
      color: $text-muted;
      font-family: $font-mono;
    }
  }
}

.kpi-detail-breakdown {
  .breakdown-title {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 1px;
    margin-bottom: $space-md;
    font-family: $font-mono;
  }
  
  .breakdown-item {
    display: flex;
    justify-content: space-between;
    padding: $space-sm 0;
    border-bottom: 1px solid $border-light;
    font-size: 12px;
    
    .breakdown-label { color: $text-secondary; }
    .breakdown-value { font-weight: 600; font-family: $font-mono; }
  }
}

// Alert Detail
.alert-detail-message {
  font-size: 16px;
  line-height: 1.5;
  margin-bottom: $space-lg;
  padding: $space-md;
  background: $bg-subtle;
  border-left: 3px solid $text-primary;
}

.alert-detail-meta {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: $space-md;
  margin-bottom: $space-lg;
  
  .meta-item {
    text-align: center;
    padding: $space-md;
    background: $bg-subtle;
    
    .meta-label { font-size: 9px; letter-spacing: 1px; color: $text-muted; margin-bottom: $space-xs; font-family: $font-mono; }
    .meta-value { font-size: 14px; font-weight: 600; font-family: $font-mono; }
  }
}

.alert-detail-actions {
  display: flex;
  gap: $space-sm;
  
  .action-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: $space-sm;
    padding: $space-md;
    background: $bg-subtle;
    border: 1px solid $border-default;
    font-size: 11px;
    font-family: $font-mono;
    cursor: pointer;
    transition: all 0.15s;
    
    &amp;:hover { background: $bg-muted; border-color: $border-strong; }
  }
}

// Weather Modal
.weather-current {
  display: flex;
  gap: $space-xl;
  margin-bottom: $space-xl;
  padding-bottom: $space-lg;
  border-bottom: 1px solid $border-light;
}

.weather-main {
  text-align: center;
  
  .weather-icon-large { font-size: 64px; display: block; margin-bottom: $space-md; }
  .weather-temp-large { font-size: 48px; font-weight: 700; }
  .weather-condition { font-size: 14px; color: $text-secondary; margin-top: $space-sm; }
}

.weather-details {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: $space-md;
  
  .weather-detail-item {
    padding: $space-md;
    background: $bg-subtle;
    text-align: center;
    
    .detail-label { font-size: 10px; color: $text-muted; margin-bottom: $space-xs; font-family: $font-mono; }
    .detail-value { font-size: 16px; font-weight: 600; }
  }
}

.weather-forecast {
  margin-bottom: $space-lg;
  
  .forecast-title { font-size: 10px; font-weight: 600; letter-spacing: 1px; margin-bottom: $space-md; font-family: $font-mono; }
  .forecast-items { display: flex; gap: $space-sm; overflow-x: auto; }
  
  .forecast-item {
    flex-shrink: 0;
    width: 60px;
    padding: $space-sm;
    background: $bg-subtle;
    text-align: center;
    
    .forecast-time { font-size: 10px; color: $text-muted; font-family: $font-mono; }
    .forecast-icon { font-size: 20px; margin: $space-sm 0; }
    .forecast-temp { font-size: 12px; font-weight: 600; }
  }
}

.weather-warnings {
  padding: $space-md;
  background: rgba($accent-warning, 0.1);
  border: 1px solid $accent-warning;
  
  .warning-title { font-size: 11px; font-weight: 600; color: $accent-warning; margin-bottom: $space-sm; }
  .warning-item { font-size: 12px; padding: $space-xs 0; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOADING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.loading-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba($bg-base, 0.95);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 4000;
}

.loading-spinner {
  width: 48px; height: 48px;
  border: 2px solid $border-default;
  border-top-color: $text-primary;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: $space-md;
}

.loading-text {
  font-size: 12px;
  letter-spacing: 2px;
  font-family: $font-mono;
  color: $text-secondary;
  margin-bottom: $space-lg;
}

.loading-progress {
  width: 200px;
  height: 4px;
  background: $border-default;
  
  .progress-bar {
    height: 100%;
    background: $text-primary;
    transition: width 0.3s ease;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RESPONSIVE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@media (max-width: 1400px) {
  .kpi-grid { grid-template-columns: repeat(2, 1fr); }
  .logistics-grid { grid-template-columns: repeat(3, 1fr); }
  .analytics-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 1024px) {
  .kz-header { padding: 0 $space-md; gap: $space-sm; }
  .logo-text { display: none; }
  .system-badge .status-text, .system-badge .version-text { display: none; }
  .kz-nav .nav-label { display: none; }
  .weather-mini .weather-temp { display: none; }
  .date-display { display: none; }
  .ops-board { grid-template-columns: 1fr; }
  .logistics-grid { grid-template-columns: repeat(2, 1fr); }
  .realtime-grid { grid-template-columns: 1fr; }
}

@media (max-width: 768px) {
  .kz-header {
    height: auto;
    flex-wrap: wrap;
    padding: $space-sm;
  }
  
  .header-left { width: 100%; justify-content: space-between; }
  .kz-nav { width: 100%; justify-content: center; border-top: 1px solid $border-light; padding-top: $space-sm; margin-top: $space-sm; }
  .header-right { display: none; }
  
  .kpi-grid { grid-template-columns: 1fr; }
  .system-grid { grid-template-columns: repeat(2, 1fr); }
  .logistics-grid { grid-template-columns: 1fr 1fr; }
  .analytics-grid { grid-template-columns: 1fr; }
  
  .kz-sidebar { width: 100%; }
  .modal-panel { width: 100%; max-width: 100%; height: 100%; max-height: 100%; }
}

@media (max-width: 480px) {
  .kz-main { padding: $space-md; }
  .section-header { flex-wrap: wrap; }
  .kpi-card { padding: $space-md; }
  .kpi-card .kpi-value { font-size: 32px; }
  .alert-header { flex-direction: column; align-items: flex-start; gap: $space-xs; }
  .footer-center { display: none; }
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>kokoro_analytics_dashboard</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Kokoro Analytics Dashboard</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[
(function() {
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // è¡¨åé…ç½® - ä¿®æ”¹ä¸ºä½ çš„å®é™…è¡¨å
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  var TABLE_REQUEST = 'x_1821654_kokoro_0_silent_wish';
  var TABLE_INVENTORY = 'x_1821654_kokoro_0_kokoro_inventory';
  
  // å­—æ®µé…ç½®
  var FLD_REQ_CONTENT = 'wish_content';
  var FLD_REQ_TRIAGE = 'triage_level';
  var FLD_REQ_ZONE = 'shelter_zone';
  var FLD_REQ_STATE = 'state';
  var FLD_REQ_ASSIGNED = 'assigned_to';
  
  var FLD_INV_ITEM_CODE = 'item_code';
  var FLD_INV_QUANTITY = 'current_quantity';
  var FLD_INV_MAX_CAP = 'max_capacity';
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // è·å–åŠ¨ä½œ
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  var action = (input && input.action) ? input.action : 'getData';
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ä¸»æ•°æ®è·å–
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  if (action === 'getData') {
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 1. KPI æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.kpis = [];
    
    // KPI 1: ACTIVE_REQUESTS
    var grActive = new GlideAggregate(TABLE_REQUEST);
    grActive.addQuery(FLD_REQ_STATE, 'IN', '1,2');
    grActive.addAggregate('COUNT');
    grActive.query();
    var activeCount = 0;
    if (grActive.next()) {
      activeCount = parseInt(grActive.getAggregate('COUNT')) || 0;
    }
    
    data.kpis.push({
      id: 'REQ',
      value: activeCount,
      label: 'ACTIVE_REQUESTS',
      status: activeCount > 50 ? 'HIGH' : 'NOMINAL',
      trend: 12.4
    });
    
    // KPI 2: AVG_RESPONSE (åˆ†é’Ÿ)
    var grClosed = new GlideRecord(TABLE_REQUEST);
    grClosed.addQuery(FLD_REQ_STATE, '3');
    grClosed.orderByDesc('sys_updated_on');
    grClosed.setLimit(50);
    grClosed.query();
    
    var totalMinutes = 0;
    var closedCount = 0;
    
    while (grClosed.next()) {
      var created = new GlideDateTime(grClosed.sys_created_on);
      var updated = new GlideDateTime(grClosed.sys_updated_on);
      var diff = Math.abs(GlideDateTime.subtract(created, updated).getNumericValue());
      totalMinutes += diff / 60000;
      closedCount++;
    }
    
    var avgMinutes = closedCount > 0 ? Math.round(totalMinutes / closedCount) : 0;
    
    data.kpis.push({
      id: 'RES',
      value: avgMinutes,
      unit: 'MIN',
      label: 'AVG_RESPONSE',
      status: avgMinutes < 30 ? 'OPTIMAL' : 'NOMINAL',
      trend: -18.2
    });
    
    // KPI 3: COMPLETION_RATE
    var grTotal = new GlideAggregate(TABLE_REQUEST);
    grTotal.addAggregate('COUNT');
    grTotal.query();
    var totalCount = 0;
    if (grTotal.next()) {
      totalCount = parseInt(grTotal.getAggregate('COUNT')) || 0;
    }
    
    var completionRate = totalCount > 0 ? ((closedCount / totalCount) * 100).toFixed(1) : 0;
    
    data.kpis.push({
      id: 'CMP',
      value: parseFloat(completionRate),
      unit: '%',
      label: 'COMPLETION_RATE',
      status: 'NOMINAL',
      trend: 0.0
    });
    
    // KPI 4: ACTIVE_OPERATORS
    var grOp = new GlideAggregate(TABLE_REQUEST);
    grOp.addQuery(FLD_REQ_ASSIGNED, '!=', '');
    grOp.addQuery(FLD_REQ_STATE, '2');
    grOp.groupBy(FLD_REQ_ASSIGNED);
    grOp.addAggregate('COUNT');
    grOp.query();
    
    var opCount = 0;
    while (grOp.next()) {
      opCount++;
    }
    
    data.kpis.push({
      id: 'OPR',
      value: opCount,
      label: 'ACTIVE_OPERATORS',
      status: 'NOMINAL',
      trend: 8.1
    });
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 2. Alerts æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.alerts = [];
    
    var grAlerts = new GlideRecord(TABLE_REQUEST);
    grAlerts.addQuery(FLD_REQ_STATE, 'IN', '1,2');
    if (grAlerts.isValidField(FLD_REQ_TRIAGE)) {
      grAlerts.orderBy(FLD_REQ_TRIAGE);
    }
    grAlerts.orderByDesc('sys_created_on');
    grAlerts.setLimit(10);
    grAlerts.query();
    
    var alertIndex = 847;
    while (grAlerts.next()) {
      var urgencyVal = 4;
      if (grAlerts.isValidField(FLD_REQ_TRIAGE)) {
        urgencyVal = parseInt(grAlerts.getValue(FLD_REQ_TRIAGE)) || 4;
      }
      
      // è®¡ç®—ç»è¿‡æ—¶é—´
      var alertCreated = new GlideDateTime(grAlerts.sys_created_on);
      var now = new GlideDateTime();
      var elapsedMs = Math.abs(GlideDateTime.subtract(alertCreated, now).getNumericValue());
      
      var h = Math.floor(elapsedMs / 3600000);
      var m = Math.floor((elapsedMs % 3600000) / 60000);
      var s = Math.floor((elapsedMs % 60000) / 1000);
      var elapsedStr = String(h).padStart(2, '0') + ':' + String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
      
      // è·å–æ¶ˆæ¯
      var msg = '';
      if (grAlerts.isValidField(FLD_REQ_CONTENT)) {
        msg = grAlerts.getDisplayValue(FLD_REQ_CONTENT);
      }
      if (!msg) {
        msg = grAlerts.getDisplayValue('short_description') || 'New request pending';
      }
      
      // è·å–åŒºåŸŸ
      var zone = 'Unknown';
      if (grAlerts.isValidField(FLD_REQ_ZONE)) {
        zone = grAlerts.getDisplayValue(FLD_REQ_ZONE) || 'Unknown';
      }
      
      data.alerts.push({
        id: 'ALT-' + String(alertIndex).padStart(4, '0'),
        priority: Math.min(4, Math.max(1, urgencyVal)),
        message: msg,
        sector: zone,
        elapsed: elapsedStr,
        sysId: grAlerts.getUniqueValue()
      });
      
      alertIndex++;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 3. Inventory æ•°æ® (å›ºå®šé¡ºåºæ˜ å°„)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.inventory = [
      { id: 'FOOD', name: 'é£Ÿæ–™', current: 0, capacity: 1000 },
      { id: 'WATR', name: 'é£²æ–™æ°´', current: 0, capacity: 1000 },
      { id: 'MEDI', name: 'åŒ»ç™‚å“', current: 0, capacity: 1000 },
      { id: 'CLTH', name: 'è¡£é¡', current: 0, capacity: 1000 },
      { id: 'HYGN', name: 'è¡›ç”Ÿç”¨å“', current: 0, capacity: 1000 }
    ];
    
    var invMap = { 'FOOD': 0, 'WATR': 1, 'MEDI': 2, 'CLTH': 3, 'HYGN': 4 };
    
    var grInv = new GlideRecord(TABLE_INVENTORY);
    grInv.query();
    
    while (grInv.next()) {
      var code = grInv.getValue(FLD_INV_ITEM_CODE);
      var idx = invMap[code];
      
      if (idx !== undefined) {
        var current = parseInt(grInv.getValue(FLD_INV_QUANTITY)) || 0;
        var max = parseInt(grInv.getValue(FLD_INV_MAX_CAP)) || 1000;
        data.inventory[idx].current = current;
        data.inventory[idx].capacity = max;
      }
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 4. Operations æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.operations = { queue: [], active: [], completed: 0 };
    var opIdx = 2000;
    
    // Queue (State = 1, New)
    var grQueue = new GlideRecord(TABLE_REQUEST);
    grQueue.addQuery(FLD_REQ_STATE, '1');
    grQueue.setLimit(10);
    grQueue.query();
    
    while (grQueue.next()) {
      var qPriority = 4;
      if (grQueue.isValidField(FLD_REQ_TRIAGE)) {
        qPriority = parseInt(grQueue.getValue(FLD_REQ_TRIAGE)) || 4;
      }
      
      var qTitle = '';
      if (grQueue.isValidField(FLD_REQ_CONTENT)) {
        qTitle = grQueue.getDisplayValue(FLD_REQ_CONTENT);
      }
      if (!qTitle) qTitle = 'Task';
      
      var qZone = 'A-01';
      if (grQueue.isValidField(FLD_REQ_ZONE)) {
        qZone = grQueue.getDisplayValue(FLD_REQ_ZONE) || 'A-01';
      }
      
      data.operations.queue.push({
        id: 'OP-' + opIdx++,
        title: qTitle,
        priority: qPriority,
        zone: qZone,
        eta: '---',
        sysId: grQueue.getUniqueValue()
      });
    }
    
    // Active (State = 2, In Progress)
    var grActive2 = new GlideRecord(TABLE_REQUEST);
    grActive2.addQuery(FLD_REQ_STATE, '2');
    grActive2.addQuery(FLD_REQ_ASSIGNED, '!=', '');
    grActive2.setLimit(10);
    grActive2.query();
    
    while (grActive2.next()) {
      var aTitle = '';
      if (grActive2.isValidField(FLD_REQ_CONTENT)) {
        aTitle = grActive2.getDisplayValue(FLD_REQ_CONTENT);
      }
      if (!aTitle) aTitle = 'Task';
      
      var aOperator = grActive2.getDisplayValue(FLD_REQ_ASSIGNED) || 'Unknown';
      if (aOperator.length > 4) aOperator = aOperator.substring(0, 4);
      
      // è®¡ç®—è¿›åº¦ (åŸºäºæ—¶é—´)
      var aCreated = new GlideDateTime(grActive2.sys_created_on);
      var aNow = new GlideDateTime();
      var aElapsed = Math.abs(GlideDateTime.subtract(aCreated, aNow).getNumericValue());
      var aProgress = Math.min(95, Math.floor(aElapsed / (1000 * 60 * 60) * 15));
      
      data.operations.active.push({
        id: 'OP-' + opIdx++,
        title: aTitle,
        operator: 'OPR-' + aOperator,
        progress: aProgress,
        sysId: grActive2.getUniqueValue()
      });
    }
    
    // Completed (24å°æ—¶å†…)
    var yesterday = new GlideDateTime();
    yesterday.addDaysUTC(-1);
    
    var grCompleted = new GlideAggregate(TABLE_REQUEST);
    grCompleted.addQuery(FLD_REQ_STATE, '3');
    grCompleted.addQuery('sys_updated_on', '>=', yesterday.getValue());
    grCompleted.addAggregate('COUNT');
    grCompleted.query();
    
    if (grCompleted.next()) {
      data.operations.completed = parseInt(grCompleted.getAggregate('COUNT')) || 0;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 5. System æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.system = {
      status: 'ONLINE',
      uptime: '99.9%',
      latency: (Math.floor(Math.random() * 20) + 35) + 'ms',
      nodes: 12
    };
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 6. Analytics æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.analytics = {
      slaHealth: 85,
      healthTrend: [60, 65, 70, 75, 80, 82, 85],
      currentHealth: 77.73,
      activeRequests: activeCount,
      volunteerUtil: opCount > 0 ? Math.round((opCount / 20) * 100) : 0,
      slaTimers: 0,
      breachTrend: [5, 8, 3, 6, 4, 7, 2]
    };
  }
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Analytics å•ç‹¬è·å–
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  if (action === 'getAnalytics') {
    var period = input.period || '24h';
    
    // æ ¹æ®æœŸé—´è°ƒæ•´æ•°æ®
    var multiplier = 1;
    if (period === '7d') multiplier = 7;
    if (period === '30d') multiplier = 30;
    
    data.analytics = {
      slaHealth: 85,
      healthTrend: [60, 65, 70, 75, 80, 82, 85],
      currentHealth: 77.73,
      activeRequests: 37,
      volunteerUtil: 45,
      slaTimers: 3,
      breachTrend: [5, 8, 3, 6, 4, 7, 2]
    };
  }
  
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-23 07:09:26</sys_created_on>
        <sys_id>5d047ae283aaf210f6b1fb96feaad36f</sys_id>
        <sys_mod_count>58</sys_mod_count>
        <sys_name>Kokoro Analytics Dashboard</sys_name>
        <sys_package display_value="Kokoro Shelter" source="x_1821654_kokoro_0">80ba4d9583863210f6b1fb96feaad3b2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Kokoro Shelter">80ba4d9583863210f6b1fb96feaad3b2</sys_scope>
        <sys_update_name>sp_widget_5d047ae283aaf210f6b1fb96feaad36f</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-02-04 07:06:46</sys_updated_on>
        <template><![CDATA[<style>
/* SNIPER PROTOCOL: ULTIMATE KILL LIST
   åŒ…å«é’ˆå¯¹ Admin å·¥å…·ã€å·¦ä¾§è°ƒè¯•å™¨ã€å³ä¾§èŠå¤©æ çš„å…¨æ–¹ä½è¦†ç›–
*/

/* 1. åŸºç¡€å…¨å±é”å®š */
html, body {
  margin: 0 !important;
  padding: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  overflow: hidden !important;
  background-color: #fafafa !important;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
}

/* 2. éšè—åŸç”Ÿå¯¼èˆªæ ã€Headerã€Footer */
nav:not(.kz-nav):not(.sidebar-nav), 
header:not(.kz-header), 
footer:not(.kz-footer),
.sp-page-header, .navbar, .polaris-header, .sn-polaris-nav, 
.navpage-header, .navpage-footer, .sp-row-background {
  display: none !important;
}

/* 3. æ ¸æ‰“å‡»ï¼šå³ä¾§ Chat & Virtual Agent */
.sn-chat-overlay, .help-button-wrapper, .sn-frameset-header,
[id*="chat"], iframe[title="Chat bot"], .tox-notifications-container {
  display: none !important;
  opacity: 0 !important;
  pointer-events: none !important;
  z-index: -9999 !important;
}

/* 4. æ ¸æ‰“å‡»ï¼šå·¦ä¾§ Admin/Designer å·¥å…· (ç»¿è‰²æŒ‰é’®) */
.sp-page-row-options, /* ç¼–è¾‘è¡Œé€‰é¡¹ */
.sp-page-toolbar,     /* é¡µé¢å·¥å…·æ  */
div[ng-if="c.options.enable_preview"], /* é¢„è§ˆå¼€å…³ */
.icon-accessibility,  /* æ— éšœç¢å›¾æ ‡ */
div[style*="left"][style*="bottom"][style*="fixed"], /* é€šç”¨å·¦ä¸‹è§’å®šä½ */
div[class*="theme-picker"],
.sp-ac-root {         /* Accessibility Root */
  display: none !important;
  visibility: hidden !important;
  width: 0 !important;
  height: 0 !important;
  pointer-events: none !important;
}

/* 5. ç¡®ä¿ KOKORO åœ¨æœ€ä¸Šå±‚ */
.kokoro-zenless {
  z-index: 2147483647 !important;
  position: relative; /* é…åˆ fixed body */
  width: 100%;
  height: 100%;
}
</style>

<div class="kokoro-zenless" ng-class="{'is-loading': c.loading, 'sidebar-open': c.sidebarOpen, 'offline-mode': c.isOffline}">
  
  <!-- ç¦»çº¿æŒ‡ç¤ºå™¨ -->
  <div class="offline-banner" ng-if="c.isOffline">
    <span class="offline-icon">âš </span>
    <span>OFFLINE MODE - ãƒ‡ãƒ¼ã‚¿ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™</span>
  </div>
  
  <!-- å™ªç‚¹çº¹ç†å±‚ -->
  <div class="noise-layer"></div>
  
  <!-- ç½‘æ ¼èƒŒæ™¯ -->
  <div class="grid-layer"></div>
  
  <!-- å››è§’è£…é¥°æ‹¬å· -->
  <div class="corner-bracket corner-tl"></div>
  <div class="corner-bracket corner-tr"></div>
  <div class="corner-bracket corner-bl"></div>
  <div class="corner-bracket corner-br"></div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ä¾§è¾¹æ  (æ±‰å ¡èœå•)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <aside class="kz-sidebar" ng-class="{'open': c.sidebarOpen}">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <span class="logo-letter">K</span>
      </div>
      <span class="sidebar-title">KOKORO</span>
      <button class="sidebar-close" ng-click="c.toggleSidebar()">âœ•</button>
    </div>
    
    <nav class="sidebar-nav">
      <div class="sidebar-section">
        <div class="sidebar-section-title">MAIN MODULES</div>
        <button class="sidebar-item" ng-click="c.setActiveTab('overview'); c.toggleSidebar()">
          <span class="sidebar-icon">â—‰</span>
          <span>Overview Dashboard</span>
        </button>
        <button class="sidebar-item" ng-click="c.setActiveTab('tactical'); c.toggleSidebar()">
          <span class="sidebar-icon">â—ˆ</span>
          <span>Tactical Map</span>
        </button>
        <button class="sidebar-item" ng-click="c.setActiveTab('operations'); c.toggleSidebar()">
          <span class="sidebar-icon">â–£</span>
          <span>Operations Board</span>
        </button>
        <button class="sidebar-item" ng-click="c.setActiveTab('logistics'); c.toggleSidebar()">
          <span class="sidebar-icon">â—‡</span>
          <span>Logistics & Analytics</span>
        </button>
      </div>
      
      <div class="sidebar-section">
        <div class="sidebar-section-title">MANAGEMENT</div>
        <button class="sidebar-item" ng-click="c.openManagementPanel('users')">
          <span class="sidebar-icon">]]>ğŸ‘¤<![CDATA[</span>
          <span>User Management</span>
        </button>
        <button class="sidebar-item" ng-click="c.openManagementPanel('volunteers')">
          <span class="sidebar-icon">]]>ğŸ¤<![CDATA[</span>
          <span>Volunteer Control</span>
        </button>
        <button class="sidebar-item" ng-click="c.openManagementPanel('shelters')">
          <span class="sidebar-icon">]]>ğŸ <![CDATA[</span>
          <span>Shelter Management</span>
        </button>
      </div>
      
      <div class="sidebar-section">
        <div class="sidebar-section-title">REAL-TIME DATA</div>
        <button class="sidebar-item" ng-click="c.openWeatherPanel()">
          <span class="sidebar-icon">]]>ğŸŒ¤<![CDATA[</span>
          <span>Weather Monitor</span>
        </button>
        <button class="sidebar-item" ng-click="c.openSeismicPanel()">
          <span class="sidebar-icon">]]>ğŸ“Š<![CDATA[</span>
          <span>Seismic Activity</span>
        </button>
        <button class="sidebar-item" ng-click="c.openTrafficPanel()">
          <span class="sidebar-icon">]]>ğŸš—<![CDATA[</span>
          <span>Traffic Status</span>
        </button>
      </div>
      
      <div class="sidebar-section">
        <div class="sidebar-section-title">SYSTEM</div>
        <button class="sidebar-item" ng-click="c.openSettings()">
          <span class="sidebar-icon">âš™</span>
          <span>Settings</span>
        </button>
        <button class="sidebar-item" ng-click="c.syncOfflineData()">
          <span class="sidebar-icon">]]>ğŸ”„<![CDATA[</span>
          <span>Sync Data</span>
        </button>
      </div>
    </nav>
    
    <div class="sidebar-footer">
      <div class="sidebar-user">
        <span class="user-avatar">{{c.user.id.charAt(0)}}</span>
        <div class="user-info">
          <div class="user-name">{{c.user.name}}</div>
          <div class="user-role">{{c.user.role}}</div>
        </div>
      </div>
    </div>
  </aside>
  
  <!-- ä¾§è¾¹æ é®ç½© -->
  <div class="sidebar-overlay" ng-if="c.sidebarOpen" ng-click="c.toggleSidebar()"></div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HEADER é¡¶éƒ¨å¯¼èˆªæ  (ä¿®å¤å¸ƒå±€)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <header class="kz-header">
    
    <!-- å·¦ä¾§: æ±‰å ¡èœå• + Logo -->
    <div class="header-left">
      <button class="hamburger-btn" ng-click="c.toggleSidebar()" title="Open Menu">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
      
      <div class="logo-group">
        <div class="logo-mark">
          <span class="logo-letter">K</span>
        </div>
        <div class="logo-text">
          <div class="logo-title">KOKORO</div>
          <div class="logo-subtitle">COMMAND_INTERFACE</div>
        </div>
      </div>
      
      <div class="system-badge" ng-class="{'online': c.systemOnline, 'offline': c.isOffline}">
        <span class="status-dot"></span>
        <span class="status-text">SYS_{{c.isOffline ? 'OFFLINE' : (c.systemOnline ? 'ONLINE' : 'ERROR')}}</span>
        <span class="version-text">{{c.version}}</span>
      </div>
    </div>
    
    <!-- ä¸­é—´: å¯¼èˆªèœå• -->
    <nav class="kz-nav">
      <button class="nav-item" 
              ng-repeat="tab in c.tabs track by tab.id"
              ng-click="c.setActiveTab(tab.id)"
              ng-class="{'active': c.activeTab === tab.id}">
        <span class="nav-code">{{tab.code}}</span>
        <span class="nav-divider">/</span>
        <span class="nav-label">{{tab.label}}</span>
      </button>
    </nav>
    
    <!-- å³ä¾§: å¤©æ°” + æ—¶é—´ + æ“ä½œå‘˜ -->
    <div class="header-right">
      <!-- è¿·ä½ å¤©æ°”æ˜¾ç¤º -->
      <div class="weather-mini" ng-click="c.openWeatherPanel()" title="å¤©æ°—è©³ç´°">
        <span class="weather-icon">{{c.weather.icon}}</span>
        <span class="weather-temp">{{c.weather.temp}}Â°C</span>
      </div>
      
      <div class="time-display">
        <div class="time-label">SYS_TIME</div>
        <div class="time-value">{{c.currentTime}}</div>
      </div>
      <div class="date-display">
        <div class="date-label">DATE</div>
        <div class="date-value">{{c.currentDate}}</div>
      </div>
      <div class="operator-badge" ng-click="c.openUserProfile()">
        <span class="operator-icon">â–£</span>
        <div class="operator-info">
          <div class="operator-label">OPERATOR</div>
          <div class="operator-id">{{c.user.id}}</div>
        </div>
      </div>
    </div>
    
  </header>
  
  <!-- è£…é¥°åˆ†å‰²çº¿ -->
  <div class="header-rule">
    <div class="rule-left"></div>
    <div class="rule-center">
      <span>â—</span>
      <span class="rule-text">DISASTER_RESPONSE_SYSTEM</span>
      <span>â—</span>
    </div>
    <div class="rule-right"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAIN ä¸»å†…å®¹åŒº
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <main class="kz-main">
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 1: OVERVIEW æ€»è§ˆ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel" ng-if="c.activeTab === 'overview'">
      
      <!-- KPI æŒ‡æ ‡å¡ç‰‡åŒº -->
      <section class="section-block section-kpi">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">01</span>
            <span class="tag-label">METRICS_OVERVIEW</span>
          </div>
          <div class="section-rule"></div>
          <div class="section-time">{{c.currentTime}}</div>
        </div>
        
        <div class="kpi-grid">
          <div class="kpi-card clickable" 
               ng-repeat="kpi in c.data.kpis track by kpi.id"
               ng-click="c.openKpiDetail(kpi)">
            <!-- åˆ‡è§’è£…é¥° -->
            <div class="chamfer-tr"></div>
            <div class="chamfer-bl"></div>
            
            <!-- ç‚¹å‡»æç¤º -->
            <div class="click-hint">CLICK FOR DETAILS</div>
            
            <div class="kpi-header">
              <span class="kpi-id">{{kpi.id}}</span>
              <span class="kpi-index">_{{$index + 1}}</span>
            </div>
            
            <div class="kpi-body">
              <span class="kpi-value">{{kpi.value}}</span>
              <span class="kpi-unit" ng-if="kpi.unit">{{kpi.unit}}</span>
            </div>
            
            <div class="kpi-label">{{kpi.label}}</div>
            
            <div class="kpi-footer">
              <span class="kpi-trend" ng-class="{
                'trend-up': kpi.trend > 0,
                'trend-down': kpi.trend < 0
              }">{{kpi.trendDisplay}}</span>
              <span class="kpi-status">[{{kpi.status}}]</span>
            </div>
            
            <!-- æ¡å½¢ç è£…é¥° -->
            <div class="barcode-deco">
              <span class="bar" ng-repeat="i in [1,2,3,4,5,6,7,8,9,10,11,12]"></span>
            </div>
          </div>
        </div>
      </section>
      
      <!-- å®æ—¶ç›‘æ§é¢æ¿ (å¤©æ°”/åœ°éœ‡/äº¤é€š) -->
      <section class="section-block section-realtime">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">RT</span>
            <span class="tag-label">REAL_TIME_MONITOR</span>
          </div>
          <div class="section-rule"></div>
        </div>
        
        <div class="realtime-grid">
          <!-- å¤©æ°”å¡ç‰‡ -->
          <div class="realtime-card weather-card" ng-click="c.openWeatherPanel()">
            <div class="realtime-icon">{{c.weather.icon}}</div>
            <div class="realtime-content">
              <div class="realtime-title">WEATHER</div>
              <div class="realtime-value">{{c.weather.temp}}Â°C</div>
              <div class="realtime-sub">{{c.weather.condition}}</div>
            </div>
            <div class="realtime-extra">
              <span>]]>ğŸ’§<![CDATA[ {{c.weather.humidity}}%</span>
              <span>]]>ğŸ’¨<![CDATA[ {{c.weather.wind}}m/s</span>
            </div>
          </div>
          
          <!-- åœ°éœ‡å¡ç‰‡ -->
          <div class="realtime-card seismic-card" ng-click="c.openSeismicPanel()" ng-class="{'alert': c.seismic.level > 3}">
            <div class="realtime-icon">]]>ğŸ“Š<![CDATA[</div>
            <div class="realtime-content">
              <div class="realtime-title">SEISMIC</div>
              <div class="realtime-value">M{{c.seismic.magnitude}}</div>
              <div class="realtime-sub">{{c.seismic.location}}</div>
            </div>
            <div class="realtime-status" ng-class="'level-' + c.seismic.level">
              {{c.seismic.status}}
            </div>
          </div>
          
          <!-- äº¤é€šå¡ç‰‡ -->
          <div class="realtime-card traffic-card" ng-click="c.openTrafficPanel()">
            <div class="realtime-icon">]]>ğŸš—<![CDATA[</div>
            <div class="realtime-content">
              <div class="realtime-title">TRAFFIC</div>
              <div class="realtime-value">{{c.traffic.status}}</div>
              <div class="realtime-sub">{{c.traffic.blockedRoutes}} routes blocked</div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- è­¦æŠ¥åˆ—è¡¨åŒº -->
      <section class="section-block section-alerts">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">02</span>
            <span class="tag-label">ALERT_FEED</span>
          </div>
          <div class="alert-count">{{c.data.alerts.length}}</div>
          <div class="section-rule"></div>
          <button class="section-action" ng-click="c.openAllAlerts()">VIEW ALL â†’</button>
        </div>
        
        <div class="alerts-list">
          <div class="alert-card clickable" 
               ng-repeat="alert in c.data.alerts track by alert.id"
               ng-class="'priority-' + alert.priority"
               ng-click="c.openAlertDetail(alert)">
            <div class="alert-priority-bar"></div>
            <div class="alert-content">
              <div class="alert-header">
                <span class="alert-id">{{alert.id}}</span>
                <span class="alert-priority-label">P{{alert.priority}}_{{alert.priorityLabel}}</span>
                <span class="alert-sector">{{alert.sector}}</span>
                <span class="alert-elapsed">{{alert.elapsed}}</span>
              </div>
              <div class="alert-message">{{alert.message}}</div>
            </div>
            <div class="alert-action">
              <span class="action-icon">â†’</span>
            </div>
          </div>
          
          <div class="alerts-empty" ng-if="c.data.alerts.length === 0">
            <span class="empty-icon">âœ“</span>
            <span>No active alerts</span>
          </div>
        </div>
      </section>
      
      <!-- åº“å­˜çŠ¶æ€åŒº -->
      <section class="section-block section-inventory">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">03</span>
            <span class="tag-label">RESOURCE_STATUS</span>
          </div>
          <div class="section-rule"></div>
        </div>
        
        <div class="inventory-list">
          <div class="inventory-item clickable" 
               ng-repeat="item in c.data.inventory track by item.id"
               ng-click="c.openInventoryDetail(item)">
            <div class="inventory-header">
              <span class="inventory-id">[{{item.id}}]</span>
              <span class="inventory-name">{{item.name}}</span>
              <span class="inventory-pct" ng-style="{'color': item.statusColor}">
                {{item.percentage}}%
              </span>
            </div>
            <div class="inventory-bar-outer">
              <div class="inventory-bar-inner" 
                   ng-style="{'width': item.percentage + '%', 'background-color': item.statusColor}">
              </div>
              <div class="scale-marker" style="left: 25%"></div>
              <div class="scale-marker" style="left: 50%"></div>
              <div class="scale-marker" style="left: 75%"></div>
            </div>
            <div class="inventory-values">
              <span class="inv-current">{{item.current}}</span>
              <span class="inv-sep">/</span>
              <span class="inv-capacity">{{item.capacity}}</span>
            </div>
          </div>
        </div>
      </section>
      
      <!-- ç³»ç»Ÿè¯Šæ–­åŒº -->
      <section class="section-block section-system">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">04</span>
            <span class="tag-label">SYSTEM_DIAGNOSTICS</span>
          </div>
          <div class="section-rule"></div>
        </div>
        
        <div class="system-grid">
          <div class="system-stat">
            <div class="stat-label">UPTIME</div>
            <div class="stat-value">{{c.data.system.uptime}}</div>
          </div>
          <div class="system-stat">
            <div class="stat-label">LATENCY</div>
            <div class="stat-value">{{c.data.system.latency}}</div>
          </div>
          <div class="system-stat">
            <div class="stat-label">NODES</div>
            <div class="stat-value">{{c.data.system.nodes}}</div>
          </div>
          <div class="system-stat">
            <div class="stat-label">STATUS</div>
            <div class="stat-value highlight">{{c.data.system.status}}</div>
          </div>
        </div>
      </section>
      
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 2: TACTICAL æˆ˜æœ¯åœ°å›¾ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel tab-tactical" ng-if="c.activeTab === 'tactical'">
      
      <!-- åœ°å›¾æ§åˆ¶é¢æ¿ -->
      <div class="map-controls">
        <div class="map-controls-header">
          <span class="controls-title">LAYERS</span>
        </div>
        <button class="map-ctrl-btn" 
                ng-repeat="ctrl in c.mapControls track by ctrl.id"
                ng-click="c.toggleMapLayer(ctrl.id)"
                ng-class="{'active': ctrl.active}">
          <span class="ctrl-icon">{{ctrl.icon}}</span>
          <span class="ctrl-label">{{ctrl.label}}</span>
          <span class="ctrl-count" ng-if="ctrl.count">({{ctrl.count}})</span>
        </button>
        
        <div class="map-controls-divider"></div>
        
        <button class="map-ctrl-btn" ng-click="c.centerMapOnUser()">
          <span class="ctrl-icon">]]>ğŸ“<![CDATA[</span>
          <span class="ctrl-label">MY LOCATION</span>
        </button>
        <button class="map-ctrl-btn" ng-click="c.refreshMapData()">
          <span class="ctrl-icon">]]>ğŸ”„<![CDATA[</span>
          <span class="ctrl-label">REFRESH</span>
        </button>
      </div>
      
      <!-- åµŒå…¥åœ°å›¾ Widget -->
      <div class="map-wrapper">
        <sp-widget widget="c.mapWidget" ng-if="c.mapWidget"></sp-widget>
        <div class="map-loading" ng-if="!c.mapWidget">
          <div class="map-loading-spinner"></div>
          <div class="map-loading-text">LOADING MAP...</div>
        </div>
      </div>
      
      <!-- åœ°å›¾ä¿¡æ¯å åŠ å±‚ -->
      <div class="map-overlay-info">
        <div class="coord-display">
          <span>LAT: {{c.mapCenter.lat}}Â°N</span>
          <span class="coord-sep">|</span>
          <span>LNG: {{c.mapCenter.lng}}Â°E</span>
          <span class="coord-sep">|</span>
          <span>ZOOM: {{c.mapZoom}}</span>
        </div>
      </div>
      
      <!-- å¿«é€Ÿæ“ä½œé¢æ¿ -->
      <div class="map-quick-actions">
        <button class="quick-action-btn emergency" ng-click="c.createEmergencyMarker()">
          <span>]]>ğŸ†˜<![CDATA[</span>
          <span>SOS</span>
        </button>
        <button class="quick-action-btn" ng-click="c.createNewRequest()">
          <span>â•</span>
          <span>REQUEST</span>
        </button>
      </div>
      
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 3: OPERATIONS ä»»åŠ¡çœ‹æ¿ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel tab-operations" ng-if="c.activeTab === 'operations'">
      
      <!-- æ“ä½œæ  -->
      <div class="ops-toolbar">
        <div class="ops-toolbar-left">
          <button class="toolbar-btn" ng-click="c.createNewTask()">
            <span>â•</span> NEW TASK
          </button>
          <button class="toolbar-btn" ng-click="c.refreshOperations()">
            <span>]]>ğŸ”„<![CDATA[</span> REFRESH
          </button>
        </div>
        <div class="ops-toolbar-right">
          <div class="ops-filter">
            <label>FILTER:</label>
            <select ng-model="c.opsFilter" ng-change="c.applyOpsFilter()">
              <option value="all">All</option>
              <option value="critical">Critical Only</option>
              <option value="my">My Tasks</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="ops-board">
        
        <!-- å¾…å¤„ç†åˆ— -->
        <div class="ops-column">
          <div class="ops-column-header">
            <span class="ops-column-tag">
              <span class="tag-icon">]]>ğŸ“‹<![CDATA[</span>
              QUEUE
            </span>
            <span class="ops-column-count">{{c.data.operations.queue.length}}</span>
          </div>
          <div class="ops-column-list">
            <div class="op-card clickable" 
                 ng-repeat="op in c.data.operations.queue track by op.id"
                 ng-click="c.openTaskDetail(op)"
                 draggable="true"
                 ng-dragstart="c.onDragStart($event, op)">
              <div class="op-card-header">
                <span class="op-priority-dot" ng-style="{'background-color': c.getPriorityColor(op.priority)}"></span>
                <span class="op-id">{{op.id}}</span>
                <span class="op-priority-badge">P{{op.priority}}</span>
              </div>
              <div class="op-title">{{op.title}}</div>
              <div class="op-meta">
                <span><span class="meta-icon">]]>ğŸ“<![CDATA[</span> {{op.zone}}</span>
                <span><span class="meta-icon">â±</span> {{op.eta}}</span>
              </div>
              <div class="op-actions">
                <button class="op-action-btn" ng-click="c.assignTask(op, $event)" title="Assign">]]>ğŸ‘¤<![CDATA[</button>
                <button class="op-action-btn" ng-click="c.startTask(op, $event)" title="Start">â–¶</button>
              </div>
            </div>
            
            <div class="ops-empty" ng-if="c.data.operations.queue.length === 0">
              <span>No pending tasks</span>
            </div>
          </div>
        </div>
        
        <!-- è¿›è¡Œä¸­åˆ— -->
        <div class="ops-column">
          <div class="ops-column-header">
            <span class="ops-column-tag">
              <span class="tag-icon">âš¡</span>
              ACTIVE
            </span>
            <span class="ops-column-count">{{c.data.operations.active.length}}</span>
          </div>
          <div class="ops-column-list">
            <div class="op-card clickable" 
                 ng-repeat="op in c.data.operations.active track by op.id"
                 ng-click="c.openTaskDetail(op)">
              <div class="op-card-header">
                <span class="op-id">{{op.id}}</span>
              </div>
              <div class="op-title">{{op.title}}</div>
              <div class="op-operator">
                <span class="op-operator-icon">â–£</span>
                <span>{{op.operator}}</span>
              </div>
              <div class="op-progress">
                <div class="op-progress-bar">
                  <div class="op-progress-fill" ng-style="{'width': op.progress + '%'}"></div>
                </div>
                <span class="op-progress-value">{{op.progress}}%</span>
              </div>
              <div class="op-actions">
                <button class="op-action-btn" ng-click="c.updateProgress(op, $event)" title="Update">]]>ğŸ“<![CDATA[</button>
                <button class="op-action-btn" ng-click="c.completeTask(op, $event)" title="Complete">âœ“</button>
              </div>
            </div>
            
            <div class="ops-empty" ng-if="c.data.operations.active.length === 0">
              <span>No active tasks</span>
            </div>
          </div>
        </div>
        
        <!-- å·²å®Œæˆåˆ— -->
        <div class="ops-column">
          <div class="ops-column-header">
            <span class="ops-column-tag">
              <span class="tag-icon">âœ“</span>
              COMPLETE
            </span>
            <span class="ops-column-count">{{c.data.operations.completed}}</span>
          </div>
          <div class="ops-completed-display">
            <div class="completed-value">{{c.data.operations.completed}}</div>
            <div class="completed-label">OPERATIONS_RESOLVED</div>
            <div class="completed-period">// 24H_CYCLE</div>
            <div class="completed-chart">
              <!-- ç®€å•çš„å®Œæˆè¶‹åŠ¿å›¾ -->
              <div class="mini-chart">
                <div class="chart-bar" ng-repeat="h in c.completedHistory" ng-style="{'height': h + '%'}"></div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
      
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 4: LOGISTICS ç‰©èµ„ç®¡ç† + Analytics â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel tab-logistics" ng-if="c.activeTab === 'logistics'">
      
      <!-- Analytics ä»ªè¡¨ç›˜ -->
      <section class="section-block section-analytics">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">PA</span>
            <span class="tag-label">PLATFORM_ANALYTICS</span>
          </div>
          <div class="section-rule"></div>
          <div class="analytics-period">
            <select ng-model="c.analyticsPeriod" ng-change="c.refreshAnalytics()">
              <option value="24h">Last 24 Hours</option>
              <option value="7d">Last 7 Days</option>
              <option value="30d">Last 30 Days</option>
            </select>
          </div>
        </div>
        
        <div class="analytics-grid">
          <!-- SLA Health -->
          <div class="analytics-card">
            <div class="analytics-card-header">
              <span class="analytics-title">Real-time SLA Health</span>
            </div>
            <div class="analytics-gauge">
              <svg viewBox="0 0 100 60" class="sla-gauge">
                <path d="M10,55 A40,40 0 0,1 90,55" fill="none" stroke="#e0e0e0" stroke-width="8"/>
                <path d="M10,55 A40,40 0 0,1 90,55" fill="none" stroke="#1a1a1a" stroke-width="8"
                      ng-attr-stroke-dasharray="{{c.analytics.slaHealth * 1.26}} 126"/>
              </svg>
              <div class="gauge-value">{{c.analytics.slaHealth}}</div>
            </div>
          </div>
          
          <!-- Health Trend -->
          <div class="analytics-card">
            <div class="analytics-card-header">
              <span class="analytics-title">7-Day Health Trend</span>
            </div>
            <div class="analytics-chart">
              <div class="trend-chart">
                <div class="trend-line">
                  <span class="trend-point" ng-repeat="p in c.analytics.healthTrend" 
                        ng-style="{'bottom': p + '%', 'left': ($index * 14) + '%'}"></span>
                </div>
                <div class="trend-value">{{c.analytics.currentHealth}}</div>
              </div>
            </div>
          </div>
          
          <!-- Active Requests -->
          <div class="analytics-card highlight">
            <div class="analytics-card-header">
              <span class="analytics-title">Active Rescue Requests</span>
            </div>
            <div class="analytics-big-number">
              {{c.analytics.activeRequests}}
            </div>
          </div>
          
          <!-- Volunteer Utilization -->
          <div class="analytics-card">
            <div class="analytics-card-header">
              <span class="analytics-title">Volunteer Utilization</span>
            </div>
            <div class="analytics-gauge">
              <svg viewBox="0 0 100 60" class="util-gauge">
                <path d="M10,55 A40,40 0 0,1 90,55" fill="none" stroke="#e0e0e0" stroke-width="8"/>
                <path d="M10,55 A40,40 0 0,1 90,55" fill="none" stroke="#404040" stroke-width="8"
                      ng-attr-stroke-dasharray="{{c.analytics.volunteerUtil * 1.26}} 126"/>
              </svg>
              <div class="gauge-value">{{c.analytics.volunteerUtil}}%</div>
            </div>
          </div>
          
          <!-- SLA Timers -->
          <div class="analytics-card">
            <div class="analytics-card-header">
              <span class="analytics-title">Active SLA Timers</span>
            </div>
            <div class="analytics-big-number">
              {{c.analytics.slaTimers}}
            </div>
          </div>
          
          <!-- Breach Rate -->
          <div class="analytics-card">
            <div class="analytics-card-header">
              <span class="analytics-title">SLA Breach Rate Trend</span>
            </div>
            <div class="analytics-mini-chart">
              <div class="breach-chart">
                <div class="breach-bar" ng-repeat="b in c.analytics.breachTrend" 
                     ng-style="{'height': b + '%'}"></div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- ç‰©èµ„åœ†ç¯ä»ªè¡¨ -->
      <section class="section-block">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">INV</span>
            <span class="tag-label">INVENTORY_GAUGES</span>
          </div>
          <div class="section-rule"></div>
        </div>
        
        <div class="logistics-grid">
          <div class="logistics-card clickable" 
               ng-repeat="item in c.data.inventory track by item.id"
               ng-click="c.openInventoryDetail(item)">
            <div class="chamfer-tr"></div>
            
            <div class="logistics-card-header">
              <span class="logistics-id">{{item.id}}</span>
              <span class="logistics-status" ng-style="{'color': item.statusColor}">
                {{item.statusLabel}}
              </span>
            </div>
            
            <div class="logistics-name">{{item.name}}</div>
            
            <div class="logistics-gauge">
              <svg viewBox="0 0 100 100" class="gauge-ring">
                <circle cx="50" cy="50" r="42" class="gauge-bg"></circle>
                <circle cx="50" cy="50" r="42" 
                        class="gauge-fill"
                        ng-attr-stroke="{{item.statusColor}}"
                        ng-attr-stroke-dasharray="{{item.percentage * 2.64}} 264"
                        transform="rotate(-90 50 50)">
                </circle>
              </svg>
              <div class="gauge-value">{{item.percentage}}%</div>
            </div>
            
            <div class="logistics-values">
              <span class="lg-current">{{item.current}}</span>
              <span class="lg-divider">/</span>
              <span class="lg-capacity">{{item.capacity}}</span>
            </div>
            
            <div class="logistics-actions">
              <button class="lg-action-btn" ng-click="c.requestRestock(item, $event)">RESTOCK</button>
            </div>
          </div>
        </div>
      </section>
      
    </div>
    
  </main>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FOOTER åº•éƒ¨çŠ¶æ€æ 
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <footer class="kz-footer">
    <div class="footer-left">
      <span class="footer-indicator" ng-class="{'offline': c.isOffline}"></span>
      <span class="footer-text">KOKORO_SYS</span>
      <span class="footer-sep">|</span>
      <span class="footer-text">STATUS: {{c.data.system.status}}</span>
      <span class="footer-sep">|</span>
      <span class="footer-text">BUILD: {{c.version}}</span>
    </div>
    <div class="footer-center">
      <span>LAT: {{c.data.system.latency}}</span>
      <span class="footer-dot">â—</span>
      <span>NODES: {{c.data.system.nodes}}</span>
      <span class="footer-dot">â—</span>
      <span>UPT: {{c.data.system.uptime}}</span>
    </div>
    <div class="footer-right">
      <span class="footer-muted">SERVICENOW_INTEGRATION</span>
      <span class="footer-sep">|</span>
      <span class="footer-muted" ng-if="c.lastSync">SYNC: {{c.lastSync}}</span>
    </div>
  </footer>
  
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL å¼¹çª—ç³»ç»Ÿ
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  
  <!-- KPI è¯¦æƒ…å¼¹çª— -->
  <div class="modal-overlay" ng-if="c.showKpiModal" ng-click="c.closeModal()">
    <div class="modal-panel modal-kpi" ng-click="$event.stopPropagation()">
      <div class="modal-header">
        <span class="modal-title">{{c.selectedKpi.id}} - {{c.selectedKpi.label}}</span>
        <button class="modal-close" ng-click="c.closeModal()">âœ•</button>
      </div>
      <div class="modal-body">
        <div class="kpi-detail-value">
          <span class="big-value">{{c.selectedKpi.value}}</span>
          <span class="big-unit" ng-if="c.selectedKpi.unit">{{c.selectedKpi.unit}}</span>
        </div>
        <div class="kpi-detail-trend">
          <span ng-class="{'positive': c.selectedKpi.trend > 0, 'negative': c.selectedKpi.trend < 0}">
            {{c.selectedKpi.trendDisplay}}
          </span>
          <span class="trend-label">vs last period</span>
        </div>
        <div class="kpi-detail-chart">
          <!-- å†å²è¶‹åŠ¿å›¾ -->
          <div class="detail-chart-container">
            <div class="chart-bar" ng-repeat="v in c.selectedKpi.history" ng-style="{'height': v + '%'}">
              <span class="chart-label">{{v}}</span>
            </div>
          </div>
        </div>
        <div class="kpi-detail-breakdown">
          <div class="breakdown-title">BREAKDOWN</div>
          <div class="breakdown-item" ng-repeat="item in c.selectedKpi.breakdown">
            <span class="breakdown-label">{{item.label}}</span>
            <span class="breakdown-value">{{item.value}}</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn" ng-click="c.exportKpiData()">EXPORT DATA</button>
        <button class="modal-btn primary" ng-click="c.closeModal()">CLOSE</button>
      </div>
    </div>
  </div>
  
  <!-- Alert è¯¦æƒ…å¼¹çª— -->
  <div class="modal-overlay" ng-if="c.showAlertModal" ng-click="c.closeModal()">
    <div class="modal-panel modal-alert" ng-click="$event.stopPropagation()">
      <div class="modal-header" ng-class="'priority-' + c.selectedAlert.priority">
        <span class="modal-title">{{c.selectedAlert.id}}</span>
        <span class="priority-badge">P{{c.selectedAlert.priority}}</span>
        <button class="modal-close" ng-click="c.closeModal()">âœ•</button>
      </div>
      <div class="modal-body">
        <div class="alert-detail-message">{{c.selectedAlert.message}}</div>
        <div class="alert-detail-meta">
          <div class="meta-item">
            <span class="meta-label">SECTOR</span>
            <span class="meta-value">{{c.selectedAlert.sector}}</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">ELAPSED</span>
            <span class="meta-value">{{c.selectedAlert.elapsed}}</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">CATEGORY</span>
            <span class="meta-value">{{c.selectedAlert.category || 'General'}}</span>
          </div>
        </div>
        <div class="alert-detail-actions">
          <button class="action-btn" ng-click="c.assignAlert(c.selectedAlert)">
            <span>]]>ğŸ‘¤<![CDATA[</span> ASSIGN
          </button>
          <button class="action-btn" ng-click="c.viewOnMap(c.selectedAlert)">
            <span>]]>ğŸ—º<![CDATA[</span> VIEW ON MAP
          </button>
          <button class="action-btn" ng-click="c.escalateAlert(c.selectedAlert)">
            <span>â¬†</span> ESCALATE
          </button>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn danger" ng-click="c.dismissAlert(c.selectedAlert)">DISMISS</button>
        <button class="modal-btn primary" ng-click="c.resolveAlert(c.selectedAlert)">RESOLVE</button>
      </div>
    </div>
  </div>
  
  <!-- å¤©æ°”é¢æ¿ -->
  <div class="modal-overlay" ng-if="c.showWeatherPanel" ng-click="c.closeModal()">
    <div class="modal-panel modal-weather wide" ng-click="$event.stopPropagation()">
      <div class="modal-header">
        <span class="modal-title">]]>ğŸŒ¤<![CDATA[ WEATHER MONITOR</span>
        <button class="modal-close" ng-click="c.closeModal()">âœ•</button>
      </div>
      <div class="modal-body">
        <div class="weather-current">
          <div class="weather-main">
            <span class="weather-icon-large">{{c.weather.icon}}</span>
            <div class="weather-temp-large">{{c.weather.temp}}Â°C</div>
            <div class="weather-condition">{{c.weather.condition}}</div>
          </div>
          <div class="weather-details">
            <div class="weather-detail-item">
              <span class="detail-label">Humidity</span>
              <span class="detail-value">{{c.weather.humidity}}%</span>
            </div>
            <div class="weather-detail-item">
              <span class="detail-label">Wind</span>
              <span class="detail-value">{{c.weather.wind}} m/s</span>
            </div>
            <div class="weather-detail-item">
              <span class="detail-label">Pressure</span>
              <span class="detail-value">{{c.weather.pressure}} hPa</span>
            </div>
            <div class="weather-detail-item">
              <span class="detail-label">Visibility</span>
              <span class="detail-value">{{c.weather.visibility}} km</span>
            </div>
          </div>
        </div>
        <div class="weather-forecast">
          <div class="forecast-title">24H FORECAST</div>
          <div class="forecast-items">
            <div class="forecast-item" ng-repeat="f in c.weather.forecast">
              <div class="forecast-time">{{f.time}}</div>
              <div class="forecast-icon">{{f.icon}}</div>
              <div class="forecast-temp">{{f.temp}}Â°</div>
            </div>
          </div>
        </div>
        <div class="weather-warnings" ng-if="c.weather.warnings.length > 0">
          <div class="warning-title">âš  WEATHER WARNINGS</div>
          <div class="warning-item" ng-repeat="w in c.weather.warnings">
            {{w}}
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- åŠ è½½è¦†ç›–å±‚ -->
  <div class="loading-overlay" ng-if="c.loading && !c.initialLoadComplete">
    <div class="loading-spinner"></div>
    <div class="loading-text">INITIALIZING_SYSTEM...</div>
    <div class="loading-progress" ng-if="c.loadingProgress">
      <div class="progress-bar" ng-style="{'width': c.loadingProgress + '%'}"></div>
    </div>
  </div>
  
</div>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>5d047ae283aaf210f6b1fb96feaad36f</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-23 07:09:26</sys_created_on>
        <sys_id>dd047ae283aaf210f6b1fb96feaad371</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-01-23 07:09:26</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
