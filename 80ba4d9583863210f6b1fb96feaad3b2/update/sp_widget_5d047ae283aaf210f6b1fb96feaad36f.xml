<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function kokoroController($scope, $timeout, $interval, spUtil) {
  /* * ä¿®å¤è¯´æ˜ï¼š
   * 1. è¿™æ˜¯ä¸€ä¸ª"å‘½åå‡½æ•°" (kokoroController)ï¼Œè§£å†³äº† "Expected ident" é”™è¯¯ã€‚
   * 2. æ³¨é‡Šæ”¾åœ¨å‡½æ•°å†…éƒ¨ï¼Œè§£å†³äº† "Must contain a function" é”™è¯¯ã€‚
   */
  
  /* jshint validthis: true */
  var c = this;
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // åˆå§‹åŒ–çŠ¶æ€
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.loading = true;
  c.systemOnline = true;
  c.version = 'v2.4.1';
  c.activeTab = 'overview';
  
  // ç”¨æˆ·ä¿¡æ¯
  c.user = {
    id: 'ADM_001',
    name: 'Administrator'
  };
  
  // åœ°å›¾ä¸­å¿ƒåæ ‡
  c.mapCenter = {
    lat: '35.6762',
    lng: '139.6503'
  };
  
  // å¯¼èˆªé…ç½®
  c.tabs = [
    { id: 'overview', label: 'OVERVIEW', code: '01' },
    { id: 'tactical', label: 'TACTICAL', code: '02' },
    { id: 'operations', label: 'OPERATIONS', code: '03' },
    { id: 'logistics', label: 'LOGISTICS', code: '04' }
  ];
  
  // åœ°å›¾å›¾å±‚æ§åˆ¶
  c.mapControls = [
    { id: 'sos', label: 'SOS_MARKERS', active: false },
    { id: 'shelter', label: 'SHELTER_LOC', active: false },
    { id: 'operator', label: 'OPERATOR_POS', active: false },
    { id: 'heatmap', label: 'HEAT_OVERLAY', active: true }
  ];
  
  // æ•°æ®åˆå§‹åŒ–
  c.data = {
    kpis: [],
    alerts: [],
    inventory: [],
    operations: {
      queue: [],
      active: [],
      completed: 0
    },
    system: {
      status: 'ONLINE',
      uptime: '---',
      latency: '---',
      nodes: 0
    }
  };
  
  // åµŒå…¥çš„åœ°å›¾ Widget å®ä¾‹
  c.mapWidget = null;
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // å·¥å…·å‡½æ•°
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * è·å–ä¼˜å…ˆçº§é¢œè‰²
   */
  c.getPriorityColor = function(priority) {
    var colors = {
      1: '#1a1a1a',  // Critical
      2: '#404040',  // High
      3: '#808080',  // Medium
      4: '#b0b0b0'   // Low
    };
    return colors[priority] || colors[4];
  };
  
  /**
   * è·å–ä¼˜å…ˆçº§æ ‡ç­¾
   */
  c.getPriorityLabel = function(priority) {
    var labels = {
      1: 'CRITICAL',
      2: 'HIGH',
      3: 'MEDIUM',
      4: 'LOW'
    };
    return labels[priority] || 'LOW';
  };
  
  /**
   * æ ¹æ®ç™¾åˆ†æ¯”è·å–çŠ¶æ€é¢œè‰²
   */
  c.getStatusColor = function(current, capacity) {
    var ratio = current / capacity;
    if (ratio < 0.2) return '#1a1a1a';
    if (ratio < 0.4) return '#404040';
    if (ratio < 0.7) return '#808080';
    return '#b0b0b0';
  };
  
  /**
   * æ ¹æ®ç™¾åˆ†æ¯”è·å–çŠ¶æ€æ ‡ç­¾
   */
  c.getStatusLabel = function(current, capacity) {
    var ratio = current / capacity;
    if (ratio < 0.2) return 'CRITICAL';
    if (ratio < 0.4) return 'LOW';
    if (ratio < 0.7) return 'NOMINAL';
    return 'OPTIMAL';
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // æ—¶é—´æ˜¾ç¤º
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  function updateTime() {
    var now = new Date();
    
    // æ ¼å¼åŒ–æ—¶é—´: HH:MM:SS
    c.currentTime = now.toLocaleTimeString('en-US', { 
      hour12: false, 
      hour: '2-digit', 
      minute: '2-digit', 
      second: '2-digit' 
    });
    
    // æ ¼å¼åŒ–æ—¥æœŸ: YYYY.MM.DD
    var year = now.getFullYear();
    var month = String(now.getMonth() + 1).padStart(2, '0');
    var day = String(now.getDate()).padStart(2, '0');
    c.currentDate = year + '.' + month + '.' + day;
  }
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // Tab åˆ‡æ¢
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.setActiveTab = function(tabId) {
    c.activeTab = tabId;
    
    // å¦‚æœåˆ‡æ¢åˆ°æˆ˜æœ¯åœ°å›¾ Tabï¼ŒåŠ è½½åœ°å›¾ Widget
    if (tabId === 'tactical' && !c.mapWidget) {
      c.loadMapWidget();
    }
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // åŠ è½½åœ°å›¾ Widget (åµŒå…¥å¼ Widget å…³é”®ä»£ç )
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * ]]>ğŸ”¥<![CDATA[ è¿™æ˜¯åµŒå…¥ä½ çš„åœ°å›¾ Widget çš„æ ¸å¿ƒæ–¹æ³• ]]>ğŸ”¥
<![CDATA[   * * å°† 'kokoro-live-map' æ›¿æ¢ä¸ºä½ å®é™…çš„åœ°å›¾ Widget ID
   */
  c.loadMapWidget = function() {
    // ä½¿ç”¨ spUtil.get() åŠ¨æ€åŠ è½½å­ Widget
    spUtil.get('kokoro_live_map', {
      // å¯ä»¥ä¼ é€’å‚æ•°ç»™åœ°å›¾ Widget
      // è¿™äº›å‚æ•°ä¼šå‡ºç°åœ¨åœ°å›¾ Widget çš„ input å¯¹è±¡ä¸­
      showControls: true,
      defaultZoom: 12,
      defaultCenter: {
        lat: parseFloat(c.mapCenter.lat),
        lng: parseFloat(c.mapCenter.lng)
      }
    }).then(function(response) {
      // ä¿å­˜ Widget å®ä¾‹
      c.mapWidget = response;
      console.log('Map widget loaded successfully');
    }).catch(function(error) {
      console.error('Failed to load map widget:', error);
    });
  };
  
  /**
   * åˆ‡æ¢åœ°å›¾å›¾å±‚
   */
  c.toggleMapLayer = function(layerId) {
    c.mapControls.forEach(function(ctrl) {
      if (ctrl.id === layerId) {
        ctrl.active = !ctrl.active;
      }
    });
    
    // å‘åœ°å›¾ Widget å¹¿æ’­å›¾å±‚åˆ‡æ¢äº‹ä»¶
    $scope.$broadcast('mapLayerToggle', {
      layerId: layerId,
      active: c.mapControls.find(function(ctrl) {
        return ctrl.id === layerId;
      }).active
    });
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // è­¦æŠ¥å¤„ç†
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.handleAlertClick = function(alert) {
    console.log('Alert clicked:', alert);
    
    // å¦‚æœæ˜¯é«˜ä¼˜å…ˆçº§è­¦æŠ¥ï¼Œåˆ‡æ¢åˆ°åœ°å›¾è§†å›¾
    if (alert.priority <= 2) {
      c.setActiveTab('tactical');
      
      // å»¶è¿Ÿå¹¿æ’­ï¼Œç¡®ä¿åœ°å›¾å·²åŠ è½½
      $timeout(function() {
        $scope.$broadcast('highlightLocation', {
          sector: alert.sector,
          priority: alert.priority,
          alertId: alert.id
        });
      }, 500);
    }
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // æ•°æ®åŠ è½½
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.loadData = function() {
    c.loading = true;
    
    // è°ƒç”¨ Server Script è·å–æ•°æ®
    c.server.get({
      action: 'getData'
    }).then(function(response) {
      if (response.data) {
        // å¤„ç† KPI æ•°æ®
        if (response.data.kpis) {
          c.data.kpis = response.data.kpis.map(function(kpi) {
            kpi.trendDisplay = (kpi.trend >= 0 ? '+' : '') + kpi.trend.toFixed(1) + '%';
            return kpi;
          });
        }
        
        // å¤„ç† Alerts æ•°æ®
        if (response.data.alerts) {
          c.data.alerts = response.data.alerts.map(function(alert) {
            alert.priorityLabel = c.getPriorityLabel(alert.priority);
            return alert;
          });
        }
        
        // å¤„ç† Inventory æ•°æ®
        if (response.data.inventory) {
          c.data.inventory = response.data.inventory.map(function(item) {
            item.percentage = Math.round((item.current / item.capacity) * 100);
            item.statusColor = c.getStatusColor(item.current, item.capacity);
            item.statusLabel = c.getStatusLabel(item.current, item.capacity);
            return item;
          });
        }
        
        // å¤„ç† Operations æ•°æ®
        if (response.data.operations) {
          c.data.operations = response.data.operations;
        }
        
        // å¤„ç† System æ•°æ®
        if (response.data.system) {
          c.data.system = response.data.system;
        }
      }
      
      c.loading = false;
      c.systemOnline = true;
      
    }).catch(function(error) {
      console.error('Data load failed:', error);
      c.loading = false;
      c.systemOnline = false;
    });
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // è‡ªåŠ¨åˆ·æ–°
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  var refreshInterval;
  var timeInterval;
  
  function startAutoRefresh() {
    // æ¯ 30 ç§’åˆ·æ–°æ•°æ®
    refreshInterval = $interval(function() {
      c.loadData();
    }, 30000);
  }
  
  function startTimeUpdate() {
    // æ¯ç§’æ›´æ–°æ—¶é—´
    timeInterval = $interval(function() {
      updateTime();
    }, 1000);
  }
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // åˆå§‹åŒ–
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  c.$onInit = function() {
    console.log('KOKORO Command Center initializing...');
    
    // åˆå§‹åŒ–æ—¶é—´æ˜¾ç¤º
    updateTime();
    startTimeUpdate();
    
    // åŠ è½½æ•°æ®
    c.loadData();
    
    // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
    startAutoRefresh();
    
    console.log('KOKORO Command Center initialized');
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // æ¸…ç†
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  $scope.$on('$destroy', function() {
    // æ¸…ç†å®šæ—¶å™¨
    if (refreshInterval) {
      $interval.cancel(refreshInterval);
    }
    if (timeInterval) {
      $interval.cancel(timeInterval);
    }
    
    console.log('KOKORO Command Center destroyed');
  });
}]]></client_script>
        <controller_as>c</controller_as>
        <css>/* 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  KOKORO COMMAND CENTER - SCSS STYLES
  ç»åŒºé›¶/é¸£æ½® ç™½è‰²å·¥ä¸šæç®€é£æ ¼
  
  å¤åˆ¶æ­¤ä»£ç åˆ° ServiceNow Widget Editor &gt; CSS - SCSS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DESIGN TOKENS è®¾è®¡å˜é‡
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// é¢œè‰²ç³»ç»Ÿ - ç™½è‰²å·¥ä¸šé£æ ¼
$bg-base: #fafafa;           // ä¸»èƒŒæ™¯
$bg-elevated: #ffffff;       // å¡ç‰‡èƒŒæ™¯
$bg-subtle: #f0f0f0;         // æ¬¡çº§èƒŒæ™¯
$bg-muted: #f8f8f8;          // æ·¡èƒŒæ™¯

$border-light: #e8e8e8;
$border-default: #e0e0e0;
$border-strong: #d0d0d0;

$text-primary: #1a1a1a;      // ä¸»æ–‡å­—
$text-secondary: #404040;    // æ¬¡çº§æ–‡å­—
$text-tertiary: #808080;     // ä¸‰çº§æ–‡å­—
$text-muted: #a0a0a0;        // å¼±åŒ–æ–‡å­—
$text-disabled: #c0c0c0;     // ç¦ç”¨æ–‡å­—

// ä¼˜å…ˆçº§é¢œè‰² (ç°é˜¶ç³»ç»Ÿ)
$priority-critical: #1a1a1a;
$priority-high: #404040;
$priority-medium: #808080;
$priority-low: #b0b0b0;

// å­—ä½“ç³»ç»Ÿ
$font-ui: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
$font-mono: 'Space Mono', 'JetBrains Mono', 'SF Mono', 'Consolas', monospace;

// é—´è·ç³»ç»Ÿ (8px ç½‘æ ¼)
$space-xs: 4px;
$space-sm: 8px;
$space-md: 16px;
$space-lg: 24px;
$space-xl: 32px;
$space-2xl: 48px;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ANIMATIONS åŠ¨ç”»
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BASE CONTAINER åŸºç¡€å®¹å™¨
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kokoro-zenless {
  min-height: 100vh;
  background: $bg-base;
  color: $text-primary;
  font-family: $font-ui;
  position: relative;
  overflow-x: hidden;
  
  * {
    box-sizing: border-box;
  }
}

// å™ªç‚¹çº¹ç†å±‚
.noise-layer {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 1000;
}

// ç½‘æ ¼èƒŒæ™¯
.grid-layer {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: 
    linear-gradient(rgba(0,0,0,0.025) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,0.025) 1px, transparent 1px);
  background-size: 48px 48px;
  pointer-events: none;
  z-index: 0;
}

// å››è§’è£…é¥°æ‹¬å·
.corner-bracket {
  position: fixed;
  width: 24px;
  height: 24px;
  border-left: 2px solid $border-strong;
  border-top: 2px solid $border-strong;
  z-index: 100;
  pointer-events: none;
  
  &amp;.corner-tl { top: 12px; left: 12px; }
  &amp;.corner-tr { top: 12px; right: 12px; transform: rotate(90deg); }
  &amp;.corner-bl { bottom: 12px; left: 12px; transform: rotate(-90deg); }
  &amp;.corner-br { bottom: 12px; right: 12px; transform: rotate(180deg); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HEADER é¡¶éƒ¨å¯¼èˆªæ 
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: $space-md $space-xl;
  background: linear-gradient(180deg, $bg-elevated 0%, $bg-subtle 100%);
  border-bottom: 1px solid $border-default;
  position: relative;
  z-index: 100;
}

.header-left {
  display: flex;
  align-items: center;
  gap: $space-xl;
}

// Logo ç»„åˆ
.logo-group {
  display: flex;
  align-items: center;
  gap: 12px;
}

.logo-mark {
  width: 40px;
  height: 40px;
  background: $text-primary;
  display: flex;
  align-items: center;
  justify-content: center;
  // åˆ‡è§’æ•ˆæœ
  clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
  
  .logo-letter {
    color: $bg-base;
    font-size: 18px;
    font-weight: 700;
    font-family: $font-mono;
  }
}

.logo-text {
  .logo-title {
    font-size: 16px;
    font-weight: 700;
    letter-spacing: 3px;
    color: $text-primary;
  }
  
  .logo-subtitle {
    font-size: 9px;
    letter-spacing: 1px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
}

// ç³»ç»ŸçŠ¶æ€å¾½ç« 
.system-badge {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: 6px 12px;
  background: $bg-subtle;
  border: 1px solid $border-default;
  
  .status-dot {
    width: 6px;
    height: 6px;
    background: $text-muted;
    border-radius: 1px;
    transition: all 0.3s ease;
  }
  
  &amp;.online .status-dot {
    background: $text-primary;
    animation: pulse 2s infinite;
  }
  
  .status-text {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 1px;
    font-family: $font-mono;
  }
  
  .version-text {
    font-size: 9px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
}

// å¯¼èˆªèœå•
.kz-nav {
  display: flex;
  gap: 4px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 10px 16px;
  background: transparent;
  border: 1px solid transparent;
  color: $text-tertiary;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 1px;
  cursor: pointer;
  font-family: $font-mono;
  transition: all 0.15s ease;
  
  &amp;:hover {
    color: $text-secondary;
    background: $bg-subtle;
  }
  
  &amp;.active {
    background: $text-primary;
    color: $bg-base;
    border-color: $text-primary;
  }
  
  .nav-code {
    opacity: 0.6;
  }
  
  .nav-divider {
    opacity: 0.3;
  }
}

// Header å³ä¾§
.header-right {
  display: flex;
  align-items: center;
  gap: $space-lg;
}

.time-display,
.date-display {
  text-align: right;
  
  [class$="-label"] {
    font-size: 8px;
    letter-spacing: 1px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
}

.time-display .time-value {
  font-size: 18px;
  font-weight: 700;
  font-family: $font-mono;
  letter-spacing: 2px;
}

.date-display .date-value {
  font-size: 11px;
  font-family: $font-mono;
  color: $text-secondary;
}

.operator-badge {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: $space-sm 14px;
  background: $bg-subtle;
  border: 1px solid $border-default;
  
  .operator-icon {
    font-size: 14px;
    color: $text-primary;
  }
  
  .operator-label {
    font-size: 8px;
    letter-spacing: 1px;
    color: $text-tertiary;
    font-family: $font-mono;
  }
  
  .operator-id {
    font-size: 11px;
    font-weight: 600;
    font-family: $font-mono;
  }
}

// è£…é¥°åˆ†å‰²çº¿
.header-rule {
  display: flex;
  align-items: center;
  padding: 0 $space-xl;
  background: $bg-subtle;
  height: 24px;
  
  .rule-left,
  .rule-right {
    flex: 1;
    height: 1px;
  }
  
  .rule-left {
    background: linear-gradient(90deg, transparent, $border-strong);
  }
  
  .rule-right {
    background: linear-gradient(90deg, $border-strong, transparent);
  }
  
  .rule-center {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 0 $space-md;
    font-size: 8px;
    color: $text-muted;
    letter-spacing: 2px;
    font-family: $font-mono;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAIN CONTENT ä¸»å†…å®¹åŒº
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-main {
  padding: $space-lg $space-xl;
  min-height: calc(100vh - 140px);
  position: relative;
  z-index: 10;
}

// Tab é¢æ¿
.tab-panel {
  animation: fadeIn 0.3s ease;
  
  &amp;.fade-in {
    animation: fadeIn 0.3s ease;
  }
}

// Section é€šç”¨æ ·å¼
.section-block {
  margin-bottom: $space-lg;
}

.section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: $space-md;
}

.section-tag {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: 4px 10px;
  background: $text-primary;
  color: $bg-base;
  
  .tag-code {
    font-size: 9px;
    font-family: $font-mono;
    opacity: 0.6;
  }
  
  .tag-label {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 1px;
    font-family: $font-mono;
  }
}

.section-rule {
  flex: 1;
  height: 1px;
  background: $border-default;
}

.section-time {
  font-size: 10px;
  color: $text-tertiary;
  font-family: $font-mono;
}

.alert-count {
  font-size: 10px;
  font-weight: 700;
  padding: 2px $space-sm;
  background: $text-primary;
  color: $bg-base;
  font-family: $font-mono;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OVERVIEW TAB æ€»è§ˆé¡µé¢
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Overview å¸ƒå±€
.tab-panel:first-child {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: $space-lg;
  
  .section-kpi,
  .section-system {
    grid-column: 1 / -1;
  }
}

// KPI å¡ç‰‡
.kpi-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: $space-md;
}

.kpi-card {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
  position: relative;
  overflow: hidden;
  transition: all 0.2s ease;
  
  &amp;:hover {
    border-color: $border-strong;
    box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  }
}

// åˆ‡è§’è£…é¥°
.chamfer-tr {
  position: absolute;
  top: 0;
  right: 0;
  width: 16px;
  height: 16px;
  background: $bg-base;
  clip-path: polygon(0 0, 100% 100%, 100% 0);
}

.chamfer-bl {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 16px;
  height: 16px;
  background: $bg-base;
  clip-path: polygon(0 0, 0 100%, 100% 100%);
}

.kpi-header {
  display: flex;
  align-items: baseline;
  margin-bottom: $space-md;
  
  .kpi-id {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1px;
    font-family: $font-mono;
  }
  
  .kpi-index {
    font-size: 9px;
    color: $text-muted;
    font-family: $font-mono;
  }
}

.kpi-body {
  display: flex;
  align-items: baseline;
  margin-bottom: $space-sm;
  
  .kpi-value {
    font-size: 42px;
    font-weight: 700;
    line-height: 1;
    letter-spacing: -1px;
  }
  
  .kpi-unit {
    font-size: 14px;
    font-weight: 500;
    color: $text-tertiary;
    margin-left: 4px;
  }
}

.kpi-label {
  font-size: 10px;
  letter-spacing: 1px;
  color: $text-tertiary;
  font-family: $font-mono;
  margin-bottom: 12px;
}

.kpi-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  .kpi-trend {
    font-size: 11px;
    font-weight: 600;
    font-family: $font-mono;
    
    &amp;.trend-up { color: $text-primary; }
    &amp;.trend-down { color: $text-secondary; }
  }
  
  .kpi-status {
    font-size: 9px;
    color: $text-muted;
    font-family: $font-mono;
  }
}

// æ¡å½¢ç è£…é¥°
.barcode-deco {
  position: absolute;
  bottom: $space-sm;
  right: $space-sm;
  display: flex;
  gap: 2px;
  align-items: flex-end;
  
  .bar {
    width: 2px;
    height: 8px;
    background: $text-primary;
    opacity: 0.1;
    
    &amp;:nth-child(odd) { height: 12px; }
    &amp;:nth-child(3n) { height: 6px; }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ALERTS SECTION è­¦æŠ¥åŒº
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-alerts {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
}

.alerts-list {
  display: flex;
  flex-direction: column;
  gap: $space-sm;
  max-height: 320px;
  overflow-y: auto;
  
  &amp;::-webkit-scrollbar {
    width: 4px;
  }
  
  &amp;::-webkit-scrollbar-thumb {
    background: $border-strong;
  }
  
  &amp;::-webkit-scrollbar-track {
    background: $bg-subtle;
  }
}

.alert-card {
  display: flex;
  align-items: stretch;
  background: $bg-muted;
  border: 1px solid $border-light;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.15s ease;
  
  &amp;:hover {
    background: $bg-subtle;
    border-color: $border-default;
  }
}

.alert-priority-bar {
  width: 3px;
  flex-shrink: 0;
  
  .priority-1 &amp; { background: $priority-critical; }
  .priority-2 &amp; { background: $priority-high; }
  .priority-3 &amp; { background: $priority-medium; }
  .priority-4 &amp; { background: $priority-low; }
}

.alert-content {
  flex: 1;
  padding: 12px $space-md;
}

.alert-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 6px;
  
  .alert-id {
    font-size: 10px;
    font-weight: 600;
    font-family: $font-mono;
  }
  
  .alert-priority-label {
    font-size: 9px;
    font-weight: 700;
    font-family: $font-mono;
    
    .priority-1 &amp; { color: $priority-critical; }
    .priority-2 &amp; { color: $priority-high; }
    .priority-3 &amp; { color: $priority-medium; }
    .priority-4 &amp; { color: $priority-low; }
  }
  
  .alert-sector {
    font-size: 9px;
    color: $text-tertiary;
    padding: 2px 6px;
    background: $bg-elevated;
    border: 1px solid $border-default;
    font-family: $font-mono;
  }
  
  .alert-elapsed {
    font-size: 10px;
    color: $text-muted;
    font-family: $font-mono;
    margin-left: auto;
  }
}

.alert-message {
  font-size: 12px;
  color: $text-secondary;
  line-height: 1.4;
}

.alert-action {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  background: $bg-subtle;
  color: $text-tertiary;
  font-size: 14px;
  transition: all 0.15s ease;
  
  &amp;:hover {
    background: $text-primary;
    color: $bg-base;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INVENTORY SECTION åº“å­˜åŒº
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-inventory {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
}

.inventory-list {
  display: flex;
  flex-direction: column;
  gap: $space-md;
}

.inventory-item {
  .inventory-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: $space-sm;
    
    .inventory-id {
      font-size: 9px;
      font-family: $font-mono;
      color: $text-tertiary;
    }
    
    .inventory-name {
      font-size: 12px;
      font-weight: 500;
      flex: 1;
    }
    
    .inventory-pct {
      font-size: 11px;
      font-weight: 700;
      font-family: $font-mono;
    }
  }
}

.inventory-bar-outer {
  height: 6px;
  background: $border-light;
  position: relative;
  margin-bottom: 6px;
}

.inventory-bar-inner {
  height: 100%;
  transition: width 0.3s ease;
}

.scale-marker {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 1px;
  background: $border-strong;
}

.inventory-values {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  font-family: $font-mono;
  
  .inv-sep { color: $text-disabled; }
  .inv-capacity { color: $text-muted; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SYSTEM SECTION ç³»ç»ŸçŠ¶æ€åŒº
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.section-system {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: 20px;
}

.system-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: $space-md;
}

.system-stat {
  text-align: center;
  padding: 20px;
  background: $bg-muted;
  border: 1px solid $border-light;
  
  .stat-label {
    font-size: 9px;
    letter-spacing: 2px;
    color: $text-tertiary;
    margin-bottom: $space-sm;
    font-family: $font-mono;
  }
  
  .stat-value {
    font-size: 20px;
    font-weight: 700;
    font-family: $font-mono;
    
    &amp;.highlight {
      color: $text-primary;
    }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TACTICAL TAB æˆ˜æœ¯åœ°å›¾
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.tab-tactical {
  height: calc(100vh - 200px);
  position: relative;
}

.map-wrapper {
  width: 100%;
  height: 100%;
  background: $bg-subtle;
  border: 1px solid $border-default;
  
  // ç¡®ä¿åµŒå…¥çš„ Widget å¡«æ»¡å®¹å™¨
  sp-widget,
  sp-widget &gt; div,
  sp-widget &gt; div &gt; div {
    display: block;
    width: 100%;
    height: 100%;
  }
}

.map-controls {
  position: absolute;
  top: $space-lg;
  left: $space-lg;
  z-index: 10;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.map-ctrl-btn {
  display: flex;
  align-items: center;
  gap: $space-sm;
  padding: 10px 14px;
  background: $bg-elevated;
  border: 1px solid $border-default;
  color: $text-tertiary;
  font-size: 10px;
  font-family: $font-mono;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.15s ease;
  
  &amp;:hover {
    background: $bg-subtle;
    border-color: $border-strong;
  }
  
  &amp;.active {
    background: $text-primary;
    border-color: $text-primary;
    color: $bg-base;
  }
  
  .ctrl-code {
    opacity: 0.5;
  }
}

.map-overlay-info {
  position: absolute;
  bottom: $space-lg;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  
  .coord-display {
    display: flex;
    gap: $space-md;
    padding: $space-sm $space-md;
    background: rgba(255,255,255,0.95);
    border: 1px solid $border-default;
    font-size: 10px;
    font-family: $font-mono;
    letter-spacing: 1px;
    
    .coord-sep {
      color: $text-disabled;
    }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OPERATIONS TAB ä»»åŠ¡çœ‹æ¿
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.tab-operations {
  height: calc(100vh - 200px);
}

.ops-board {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  height: 100%;
}

.ops-column {
  background: $bg-elevated;
  border: 1px solid $border-default;
  display: flex;
  flex-direction: column;
}

.ops-column-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: $space-md;
  border-bottom: 1px solid $border-default;
  
  .ops-column-tag {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 2px;
    font-family: $font-mono;
  }
  
  .ops-column-count {
    font-size: 10px;
    padding: 2px $space-sm;
    background: $bg-subtle;
    font-family: $font-mono;
  }
}

.ops-column-list {
  flex: 1;
  padding: $space-md;
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-y: auto;
}

.op-card {
  background: $bg-muted;
  border: 1px solid $border-light;
  padding: $space-md;
  transition: all 0.15s ease;
  
  &amp;:hover {
    border-color: $border-default;
  }
}

.op-card-header {
  display: flex;
  align-items: center;
  gap: $space-sm;
  margin-bottom: $space-sm;
  
  .op-priority-dot {
    width: 6px;
    height: 6px;
  }
  
  .op-id {
    font-size: 10px;
    font-family: $font-mono;
    color: $text-tertiary;
  }
}

.op-title {
  font-size: 13px;
  font-weight: 500;
  margin-bottom: $space-sm;
}

.op-meta {
  display: flex;
  gap: $space-md;
  font-size: 10px;
  color: $text-muted;
  font-family: $font-mono;
}

.op-operator {
  display: flex;
  align-items: center;
  gap: $space-sm;
  margin-bottom: 12px;
  font-size: 11px;
  
  .op-operator-icon {
    color: $text-primary;
  }
}

.op-progress {
  display: flex;
  align-items: center;
  gap: 12px;
}

.op-progress-bar {
  flex: 1;
  height: 4px;
  background: $border-default;
}

.op-progress-fill {
  height: 100%;
  background: $text-primary;
  transition: width 0.3s ease;
}

.op-progress-value {
  font-size: 11px;
  font-weight: 600;
  font-family: $font-mono;
  min-width: 35px;
}

// å·²å®Œæˆæ˜¾ç¤º
.ops-completed-display {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  
  .completed-value {
    font-size: 72px;
    font-weight: 700;
    line-height: 1;
  }
  
  .completed-label {
    font-size: 11px;
    letter-spacing: 2px;
    color: $text-tertiary;
    margin-top: $space-md;
    font-family: $font-mono;
  }
  
  .completed-period {
    font-size: 10px;
    color: $text-muted;
    margin-top: $space-sm;
    font-family: $font-mono;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOGISTICS TAB ç‰©èµ„ç®¡ç†
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.tab-logistics {
  .logistics-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 20px;
  }
}

.logistics-card {
  background: $bg-elevated;
  border: 1px solid $border-default;
  padding: $space-lg;
  text-align: center;
  position: relative;
}

.logistics-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: $space-sm;
  
  .logistics-id {
    font-size: 10px;
    font-weight: 600;
    font-family: $font-mono;
  }
  
  .logistics-status {
    font-size: 9px;
    font-weight: 700;
    font-family: $font-mono;
  }
}

.logistics-name {
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 20px;
}

.logistics-gauge {
  position: relative;
  width: 100px;
  height: 100px;
  margin: 0 auto $space-md;
  
  .gauge-ring {
    width: 100%;
    height: 100%;
  }
  
  .gauge-bg {
    fill: none;
    stroke: $border-light;
    stroke-width: 6;
  }
  
  .gauge-fill {
    fill: none;
    stroke-width: 6;
    stroke-linecap: square;
    transition: stroke-dasharray 0.5s ease;
  }
  
  .gauge-value {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 22px;
    font-weight: 700;
    font-family: $font-mono;
  }
}

.logistics-values {
  font-size: 12px;
  font-family: $font-mono;
  
  .lg-current { font-weight: 600; }
  .lg-divider { color: $text-disabled; margin: 0 4px; }
  .lg-capacity { color: $text-muted; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FOOTER åº•éƒ¨çŠ¶æ€æ 
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.kz-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px $space-xl;
  background: $bg-subtle;
  border-top: 1px solid $border-default;
  font-size: 10px;
  font-family: $font-mono;
  color: $text-tertiary;
  letter-spacing: 1px;
}

.footer-left,
.footer-center {
  display: flex;
  align-items: center;
  gap: 12px;
}

.footer-indicator {
  width: 6px;
  height: 6px;
  background: $text-primary;
  border-radius: 1px;
}

.footer-sep {
  color: $text-disabled;
}

.footer-dot {
  color: $text-disabled;
  font-size: 6px;
}

.footer-muted {
  color: $text-muted;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOADING OVERLAY åŠ è½½è¦†ç›–å±‚
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba($bg-base, 0.95);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 2px solid $border-default;
  border-top-color: $text-primary;
  animation: spin 1s linear infinite;
  margin-bottom: $space-md;
}

.loading-text {
  font-size: 11px;
  letter-spacing: 2px;
  font-family: $font-mono;
  color: $text-secondary;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RESPONSIVE å“åº”å¼
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@media (max-width: 1400px) {
  .kpi-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .logistics-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 1024px) {
  .kz-header {
    flex-direction: column;
    gap: $space-md;
    padding: $space-md;
  }
  
  .kz-nav {
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .ops-board {
    grid-template-columns: 1fr;
    height: auto;
  }
  
  .logistics-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .kpi-grid {
    grid-template-columns: 1fr;
  }
  
  .system-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .logistics-grid {
    grid-template-columns: 1fr 1fr;
  }
  
  .tab-panel:first-child {
    grid-template-columns: 1fr;
  }
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>kokoro_analytics_dashboard</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Kokoro Analytics Dashboard</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[/* 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  KOKORO COMMAND CENTER - SERVER SCRIPT
  ç»åŒºé›¶/é¸£æ½® ç™½è‰²å·¥ä¸šæç®€é£æ ¼
  
  å¤åˆ¶æ­¤ä»£ç åˆ° ServiceNow Widget Editor > Server Script
  
  âš ï¸ é‡è¦: å°†ä¸‹é¢çš„è¡¨åæ›¿æ¢ä¸ºä½ å®é™…çš„è¡¨å
  ä¾‹å¦‚: 'x_1460867_kokoro_request' â†’ 'x_YOUR_SCOPE_request'
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/

(function() {
  
  // ä» Client Script æ¥æ”¶çš„åŠ¨ä½œ
  var action = (input && input.action) ? input.action : 'getData';
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ä¸»æ•°æ®è·å–
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  if (action === 'getData') {
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // KPI æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.kpis = [];
    
    // KPI 1: æ´»è·ƒè¯·æ±‚æ•°
    var grActive = new GlideAggregate('x_1821654_kokoro_0_silent_wish');
    grActive.addQuery('state', 'IN', '1,2'); // New, In Progress
    grActive.addAggregate('COUNT');
    grActive.query();
    
    var activeCount = 0;
    if (grActive.next()) {
      activeCount = parseInt(grActive.getAggregate('COUNT')) || 0;
    }
    
    data.kpis.push({
      id: 'REQ',
      value: activeCount,
      label: 'ACTIVE_REQUESTS',
      status: 'NOMINAL',
      trend: 12.4
    });
    
    // KPI 2: å¹³å‡å“åº”æ—¶é—´ (åˆ†é’Ÿ)
    var grClosed = new GlideRecord('x_1821654_kokoro_0_silent_wish');
    grClosed.addQuery('state', '3'); // Closed
    grClosed.orderByDesc('sys_updated_on');
    grClosed.setLimit(100);
    grClosed.query();
    
    var totalMinutes = 0;
    var closedCount = 0;
    
    while (grClosed.next()) {
      var created = new GlideDateTime(grClosed.sys_created_on);
      var updated = new GlideDateTime(grClosed.sys_updated_on);
      var diff = GlideDateTime.subtract(created, updated);
      totalMinutes += Math.abs(diff.getNumericValue()) / (1000 * 60);
      closedCount++;
    }
    
    var avgMinutes = closedCount > 0 ? Math.round(totalMinutes / closedCount) : 0;
    
    data.kpis.push({
      id: 'RES',
      value: avgMinutes,
      unit: 'MIN',
      label: 'AVG_RESPONSE',
      status: avgMinutes < 30 ? 'OPTIMAL' : 'NOMINAL',
      trend: -18.2
    });
    
    // KPI 3: å®Œæˆç‡
    var grTotal = new GlideAggregate('x_1460867_kokoro_request');
    grTotal.addAggregate('COUNT');
    grTotal.query();
    
    var totalCount = 0;
    if (grTotal.next()) {
      totalCount = parseInt(grTotal.getAggregate('COUNT')) || 0;
    }
    
    var completionRate = totalCount > 0 ? ((closedCount / totalCount) * 100).toFixed(1) : 0;
    
    data.kpis.push({
      id: 'CMP',
      value: parseFloat(completionRate),
      unit: '%',
      label: 'COMPLETION_RATE',
      status: 'NOMINAL',
      trend: 0
    });
    
    // KPI 4: æ´»è·ƒæ“ä½œå‘˜æ•°
    var grOperators = new GlideAggregate('x_1460867_kokoro_request');
    grOperators.addQuery('assigned_to', '!=', '');
    grOperators.addQuery('state', '2'); // In Progress
    grOperators.groupBy('assigned_to');
    grOperators.addAggregate('COUNT');
    grOperators.query();
    
    var operatorCount = 0;
    while (grOperators.next()) {
      operatorCount++;
    }
    
    data.kpis.push({
      id: 'OPR',
      value: operatorCount,
      label: 'ACTIVE_OPERATORS',
      status: 'NOMINAL',
      trend: 8.1
    });
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Alerts æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.alerts = [];
    
    var grAlerts = new GlideRecord('x_1460867_kokoro_request');
    grAlerts.addQuery('state', 'IN', '1,2');
    grAlerts.orderBy('urgency');
    grAlerts.orderByDesc('sys_created_on');
    grAlerts.setLimit(10);
    grAlerts.query();
    
    var alertIndex = 847;
    while (grAlerts.next()) {
      var urgency = parseInt(grAlerts.getValue('urgency')) || 4;
      var priority = Math.min(4, Math.max(1, urgency));
      
      // è®¡ç®—ç»è¿‡æ—¶é—´
      var created = new GlideDateTime(grAlerts.sys_created_on);
      var now = new GlideDateTime();
      var elapsed = GlideDateTime.subtract(created, now);
      var elapsedMs = Math.abs(elapsed.getNumericValue());
      
      var hours = Math.floor(elapsedMs / (1000 * 60 * 60));
      var mins = Math.floor((elapsedMs % (1000 * 60 * 60)) / (1000 * 60));
      var secs = Math.floor((elapsedMs % (1000 * 60)) / 1000);
      
      var elapsedStr = String(hours).padStart(2, '0') + ':' + 
                       String(mins).padStart(2, '0') + ':' + 
                       String(secs).padStart(2, '0');
      
      data.alerts.push({
        id: 'ALT-' + String(alertIndex).padStart(4, '0'),
        priority: priority,
        message: grAlerts.getDisplayValue('short_description') || 'New request pending',
        sector: grAlerts.getDisplayValue('location') || 'SEC-' + String.fromCharCode(65 + (alertIndex % 4)),
        elapsed: elapsedStr
      });
      
      alertIndex++;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Inventory æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.inventory = [];
    
    var categories = [
      { id: 'FOOD', name: 'é£Ÿæ–™', category: 'food' },
      { id: 'WATR', name: 'é£²æ–™æ°´', category: 'water' },
      { id: 'MEDI', name: 'åŒ»ç™‚å“', category: 'medical' },
      { id: 'CLTH', name: 'è¡£é¡', category: 'clothing' },
      { id: 'HYGN', name: 'è¡›ç”Ÿç”¨å“', category: 'hygiene' }
    ];
    
    categories.forEach(function(cat) {
      var grInv = new GlideAggregate('x_1460867_kokoro_inventory');
      grInv.addQuery('category', cat.category);
      grInv.addAggregate('SUM', 'quantity');
      grInv.query();
      
      var currentQty = 0;
      if (grInv.next()) {
        currentQty = parseInt(grInv.getAggregate('SUM', 'quantity')) || 0;
      }
      
      // é»˜è®¤å®¹é‡
      var capacity = 1000;
      
      data.inventory.push({
        id: cat.id,
        name: cat.name,
        current: currentQty,
        capacity: capacity
      });
    });
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Operations æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.operations = {
      queue: [],
      active: [],
      completed: 0
    };
    
    // Queue (å¾…å¤„ç†)
    var grQueue = new GlideRecord('x_1460867_kokoro_request');
    grQueue.addQuery('state', '1'); // New
    grQueue.orderBy('urgency');
    grQueue.setLimit(10);
    grQueue.query();
    
    var opIndex = 2847;
    while (grQueue.next()) {
      var urgency = parseInt(grQueue.getValue('urgency')) || 4;
      
      data.operations.queue.push({
        id: 'OP-' + opIndex,
        title: grQueue.getDisplayValue('short_description') || 'Task',
        priority: Math.min(4, Math.max(1, urgency)),
        zone: grQueue.getDisplayValue('location') || 'A-01',
        eta: '---'
      });
      opIndex++;
    }
    
    // Active (è¿›è¡Œä¸­)
    var grActive2 = new GlideRecord('x_1460867_kokoro_request');
    grActive2.addQuery('state', '2');
    grActive2.addQuery('assigned_to', '!=', '');
    grActive2.setLimit(10);
    grActive2.query();
    
    while (grActive2.next()) {
      // ä¼°ç®—è¿›åº¦
      var created = new GlideDateTime(grActive2.sys_created_on);
      var now = new GlideDateTime();
      var elapsed = Math.abs(GlideDateTime.subtract(created, now).getNumericValue());
      var progress = Math.min(95, Math.floor(elapsed / (1000 * 60 * 60) * 15));
      
      data.operations.active.push({
        id: 'OP-' + opIndex,
        title: grActive2.getDisplayValue('short_description') || 'Task',
        operator: 'OPR-' + (grActive2.getDisplayValue('assigned_to') || 'Unknown').substring(0, 4),
        progress: progress
      });
      opIndex++;
    }
    
    // Completed (24å°æ—¶å†…å®Œæˆ)
    var yesterday = new GlideDateTime();
    yesterday.addDaysUTC(-1);
    
    var grCompleted = new GlideAggregate('x_1460867_kokoro_request');
    grCompleted.addQuery('state', '3');
    grCompleted.addQuery('sys_updated_on', '>=', yesterday.getValue());
    grCompleted.addAggregate('COUNT');
    grCompleted.query();
    
    if (grCompleted.next()) {
      data.operations.completed = parseInt(grCompleted.getAggregate('COUNT')) || 0;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // System æ•°æ®
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    data.system = {
      status: 'ONLINE',
      uptime: '99.72%',
      latency: (Math.floor(Math.random() * 20) + 35) + 'ms',
      nodes: 12
    };
    
  }
  
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-23 07:09:26</sys_created_on>
        <sys_id>5d047ae283aaf210f6b1fb96feaad36f</sys_id>
        <sys_mod_count>9</sys_mod_count>
        <sys_name>Kokoro Analytics Dashboard</sys_name>
        <sys_package display_value="Kokoro Shelter" source="x_1821654_kokoro_0">80ba4d9583863210f6b1fb96feaad3b2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Kokoro Shelter">80ba4d9583863210f6b1fb96feaad3b2</sys_scope>
        <sys_update_name>sp_widget_5d047ae283aaf210f6b1fb96feaad36f</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-01-30 01:38:09</sys_updated_on>
        <template><![CDATA[<!-- 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  KOKORO COMMAND CENTER - HTML TEMPLATE
  ç»åŒºé›¶/é¸£æ½® ç™½è‰²å·¥ä¸šæç®€é£æ ¼
  
  å¤åˆ¶æ­¤ä»£ç åˆ° ServiceNow Widget Editor > HTML Template
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->

<div class="kokoro-zenless" ng-class="{'is-loading': c.loading}">
  
  <!-- å™ªç‚¹çº¹ç†å±‚ -->
  <div class="noise-layer"></div>
  
  <!-- ç½‘æ ¼èƒŒæ™¯ -->
  <div class="grid-layer"></div>
  
  <!-- å››è§’è£…é¥°æ‹¬å· -->
  <div class="corner-bracket corner-tl"></div>
  <div class="corner-bracket corner-tr"></div>
  <div class="corner-bracket corner-bl"></div>
  <div class="corner-bracket corner-br"></div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HEADER é¡¶éƒ¨å¯¼èˆªæ 
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <header class="kz-header">
    
    <!-- å·¦ä¾§: Logo + ç³»ç»ŸçŠ¶æ€ -->
    <div class="header-left">
      <div class="logo-group">
        <div class="logo-mark">
          <span class="logo-letter">K</span>
        </div>
        <div class="logo-text">
          <div class="logo-title">KOKORO</div>
          <div class="logo-subtitle">COMMAND_INTERFACE</div>
        </div>
      </div>
      
      <div class="system-badge" ng-class="{'online': c.systemOnline}">
        <span class="status-dot"></span>
        <span class="status-text">SYS_{{c.systemOnline ? 'ONLINE' : 'OFFLINE'}}</span>
        <span class="version-text">{{c.version}}</span>
      </div>
    </div>
    
    <!-- ä¸­é—´: å¯¼èˆªèœå• -->
    <nav class="kz-nav">
      <button class="nav-item" 
              ng-repeat="tab in c.tabs track by tab.id"
              ng-click="c.setActiveTab(tab.id)"
              ng-class="{'active': c.activeTab === tab.id}">
        <span class="nav-code">{{tab.code}}</span>
        <span class="nav-divider">/</span>
        <span class="nav-label">{{tab.label}}</span>
      </button>
    </nav>
    
    <!-- å³ä¾§: æ—¶é—´ + æ“ä½œå‘˜ -->
    <div class="header-right">
      <div class="time-display">
        <div class="time-label">SYS_TIME</div>
        <div class="time-value">{{c.currentTime}}</div>
      </div>
      <div class="date-display">
        <div class="date-label">DATE</div>
        <div class="date-value">{{c.currentDate}}</div>
      </div>
      <div class="operator-badge">
        <span class="operator-icon">â–£</span>
        <div class="operator-info">
          <div class="operator-label">OPERATOR</div>
          <div class="operator-id">{{c.user.id}}</div>
        </div>
      </div>
    </div>
    
  </header>
  
  <!-- è£…é¥°åˆ†å‰²çº¿ -->
  <div class="header-rule">
    <div class="rule-left"></div>
    <div class="rule-center">
      <span>â—</span>
      <span class="rule-text">DISASTER_RESPONSE_SYSTEM</span>
      <span>â—</span>
    </div>
    <div class="rule-right"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAIN ä¸»å†…å®¹åŒº
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <main class="kz-main">
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 1: OVERVIEW æ€»è§ˆ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel" ng-if="c.activeTab === 'overview'" ng-class="{'fade-in': true}">
      
      <!-- KPI æŒ‡æ ‡å¡ç‰‡åŒº -->
      <section class="section-block section-kpi">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">01</span>
            <span class="tag-label">METRICS_OVERVIEW</span>
          </div>
          <div class="section-rule"></div>
          <div class="section-time">{{c.currentTime}}</div>
        </div>
        
        <div class="kpi-grid">
          <div class="kpi-card" ng-repeat="kpi in c.data.kpis track by kpi.id">
            <!-- åˆ‡è§’è£…é¥° -->
            <div class="chamfer-tr"></div>
            <div class="chamfer-bl"></div>
            
            <div class="kpi-header">
              <span class="kpi-id">{{kpi.id}}</span>
              <span class="kpi-index">_{{$index + 1 | limitTo:2}}</span>
            </div>
            
            <div class="kpi-body">
              <span class="kpi-value">{{kpi.value}}</span>
              <span class="kpi-unit" ng-if="kpi.unit">{{kpi.unit}}</span>
            </div>
            
            <div class="kpi-label">{{kpi.label}}</div>
            
            <div class="kpi-footer">
              <span class="kpi-trend" ng-class="{
                'trend-up': kpi.trend > 0,
                'trend-down': kpi.trend < 0
              }">{{kpi.trendDisplay}}</span>
              <span class="kpi-status">[{{kpi.status}}]</span>
            </div>
            
            <!-- æ¡å½¢ç è£…é¥° -->
            <div class="barcode-deco">
              <span class="bar" ng-repeat="i in [1,2,3,4,5,6,7,8,9,10,11,12]"></span>
            </div>
          </div>
        </div>
      </section>
      
      <!-- è­¦æŠ¥åˆ—è¡¨åŒº -->
      <section class="section-block section-alerts">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">02</span>
            <span class="tag-label">ALERT_FEED</span>
          </div>
          <div class="alert-count">{{c.data.alerts.length}}</div>
          <div class="section-rule"></div>
        </div>
        
        <div class="alerts-list">
          <div class="alert-card" 
               ng-repeat="alert in c.data.alerts track by alert.id"
               ng-class="'priority-' + alert.priority"
               ng-click="c.handleAlertClick(alert)">
            <div class="alert-priority-bar"></div>
            <div class="alert-content">
              <div class="alert-header">
                <span class="alert-id">{{alert.id}}</span>
                <span class="alert-priority-label">P{{alert.priority}}_{{alert.priorityLabel}}</span>
                <span class="alert-sector">{{alert.sector}}</span>
                <span class="alert-elapsed">{{alert.elapsed}}</span>
              </div>
              <div class="alert-message">{{alert.message}}</div>
            </div>
            <div class="alert-action">â†’</div>
          </div>
        </div>
      </section>
      
      <!-- åº“å­˜çŠ¶æ€åŒº -->
      <section class="section-block section-inventory">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">03</span>
            <span class="tag-label">RESOURCE_STATUS</span>
          </div>
          <div class="section-rule"></div>
        </div>
        
        <div class="inventory-list">
          <div class="inventory-item" ng-repeat="item in c.data.inventory track by item.id">
            <div class="inventory-header">
              <span class="inventory-id">[{{item.id}}]</span>
              <span class="inventory-name">{{item.name}}</span>
              <span class="inventory-pct" ng-style="{'color': item.statusColor}">
                {{item.percentage}}%
              </span>
            </div>
            <div class="inventory-bar-outer">
              <div class="inventory-bar-inner" 
                   ng-style="{'width': item.percentage + '%', 'background-color': item.statusColor}">
              </div>
              <div class="scale-marker" style="left: 25%"></div>
              <div class="scale-marker" style="left: 50%"></div>
              <div class="scale-marker" style="left: 75%"></div>
            </div>
            <div class="inventory-values">
              <span class="inv-current">{{item.current}}</span>
              <span class="inv-sep">/</span>
              <span class="inv-capacity">{{item.capacity}}</span>
            </div>
          </div>
        </div>
      </section>
      
      <!-- ç³»ç»Ÿè¯Šæ–­åŒº -->
      <section class="section-block section-system">
        <div class="section-header">
          <div class="section-tag">
            <span class="tag-code">04</span>
            <span class="tag-label">SYSTEM_DIAGNOSTICS</span>
          </div>
          <div class="section-rule"></div>
        </div>
        
        <div class="system-grid">
          <div class="system-stat">
            <div class="stat-label">UPTIME</div>
            <div class="stat-value">{{c.data.system.uptime}}</div>
          </div>
          <div class="system-stat">
            <div class="stat-label">LATENCY</div>
            <div class="stat-value">{{c.data.system.latency}}</div>
          </div>
          <div class="system-stat">
            <div class="stat-label">NODES</div>
            <div class="stat-value">{{c.data.system.nodes}}</div>
          </div>
          <div class="system-stat">
            <div class="stat-label">STATUS</div>
            <div class="stat-value highlight">{{c.data.system.status}}</div>
          </div>
        </div>
      </section>
      
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 2: TACTICAL æˆ˜æœ¯åœ°å›¾ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- ]]>ğŸ”¥<![CDATA[ è¿™é‡ŒåµŒå…¥ä½ çš„ Mapbox åœ°å›¾ Widget ]]>ğŸ”¥<![CDATA[ -->
    <div class="tab-panel tab-tactical" ng-if="c.activeTab === 'tactical'">
      
      <!-- åœ°å›¾æ§åˆ¶é¢æ¿ -->
      <div class="map-controls">
        <button class="map-ctrl-btn" 
                ng-repeat="ctrl in c.mapControls track by ctrl.id"
                ng-click="c.toggleMapLayer(ctrl.id)"
                ng-class="{'active': ctrl.active}">
          <span class="ctrl-code">{{$index + 1 | limitTo:2}}</span>
          <span class="ctrl-label">{{ctrl.label}}</span>
        </button>
      </div>
      
      <!-- åµŒå…¥åœ°å›¾ Widget -->
      <div class="map-wrapper">
        <sp-widget widget="c.mapWidget"></sp-widget>
      </div>
      
      <!-- åœ°å›¾ä¿¡æ¯å åŠ å±‚ -->
      <div class="map-overlay-info">
        <div class="coord-display">
          <span>LAT: {{c.mapCenter.lat}}Â°N</span>
          <span class="coord-sep">|</span>
          <span>LNG: {{c.mapCenter.lng}}Â°E</span>
        </div>
      </div>
      
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 3: OPERATIONS ä»»åŠ¡çœ‹æ¿ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel tab-operations" ng-if="c.activeTab === 'operations'">
      
      <div class="ops-board">
        
        <!-- å¾…å¤„ç†åˆ— -->
        <div class="ops-column">
          <div class="ops-column-header">
            <span class="ops-column-tag">QUEUE</span>
            <span class="ops-column-count">{{c.data.operations.queue.length}}</span>
          </div>
          <div class="ops-column-list">
            <div class="op-card" ng-repeat="op in c.data.operations.queue track by op.id">
              <div class="op-card-header">
                <span class="op-priority-dot" ng-style="{'background-color': c.getPriorityColor(op.priority)}"></span>
                <span class="op-id">{{op.id}}</span>
              </div>
              <div class="op-title">{{op.title}}</div>
              <div class="op-meta">
                <span>ZONE: {{op.zone}}</span>
                <span>ETA: {{op.eta}}</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- è¿›è¡Œä¸­åˆ— -->
        <div class="ops-column">
          <div class="ops-column-header">
            <span class="ops-column-tag">ACTIVE</span>
            <span class="ops-column-count">{{c.data.operations.active.length}}</span>
          </div>
          <div class="ops-column-list">
            <div class="op-card" ng-repeat="op in c.data.operations.active track by op.id">
              <div class="op-card-header">
                <span class="op-id">{{op.id}}</span>
              </div>
              <div class="op-title">{{op.title}}</div>
              <div class="op-operator">
                <span class="op-operator-icon">â–£</span>
                <span>{{op.operator}}</span>
              </div>
              <div class="op-progress">
                <div class="op-progress-bar">
                  <div class="op-progress-fill" ng-style="{'width': op.progress + '%'}"></div>
                </div>
                <span class="op-progress-value">{{op.progress}}%</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- å·²å®Œæˆåˆ— -->
        <div class="ops-column">
          <div class="ops-column-header">
            <span class="ops-column-tag">COMPLETE</span>
            <span class="ops-column-count">{{c.data.operations.completed}}</span>
          </div>
          <div class="ops-completed-display">
            <div class="completed-value">{{c.data.operations.completed}}</div>
            <div class="completed-label">OPERATIONS_RESOLVED</div>
            <div class="completed-period">// 24H_CYCLE</div>
          </div>
        </div>
        
      </div>
      
    </div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 4: LOGISTICS ç‰©èµ„ç®¡ç† â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-panel tab-logistics" ng-if="c.activeTab === 'logistics'">
      
      <div class="logistics-grid">
        <div class="logistics-card" ng-repeat="item in c.data.inventory track by item.id">
          <div class="chamfer-tr"></div>
          
          <div class="logistics-card-header">
            <span class="logistics-id">{{item.id}}</span>
            <span class="logistics-status" ng-style="{'color': item.statusColor}">
              {{item.statusLabel}}
            </span>
          </div>
          
          <div class="logistics-name">{{item.name}}</div>
          
          <div class="logistics-gauge">
            <svg viewBox="0 0 100 100" class="gauge-ring">
              <circle cx="50" cy="50" r="42" class="gauge-bg"></circle>
              <circle cx="50" cy="50" r="42" 
                      class="gauge-fill"
                      ng-attr-stroke="{{item.statusColor}}"
                      ng-attr-stroke-dasharray="{{item.percentage * 2.64}} 264"
                      transform="rotate(-90 50 50)">
              </circle>
            </svg>
            <div class="gauge-value">{{item.percentage}}%</div>
          </div>
          
          <div class="logistics-values">
            <span class="lg-current">{{item.current}}</span>
            <span class="lg-divider">/</span>
            <span class="lg-capacity">{{item.capacity}}</span>
          </div>
        </div>
      </div>
      
    </div>
    
  </main>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FOOTER åº•éƒ¨çŠ¶æ€æ 
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <footer class="kz-footer">
    <div class="footer-left">
      <span class="footer-indicator"></span>
      <span class="footer-text">KOKORO_SYS</span>
      <span class="footer-sep">|</span>
      <span class="footer-text">STATUS: {{c.data.system.status}}</span>
      <span class="footer-sep">|</span>
      <span class="footer-text">BUILD: {{c.version}}</span>
    </div>
    <div class="footer-center">
      <span>LAT: {{c.data.system.latency}}</span>
      <span class="footer-dot">â—</span>
      <span>NODES: {{c.data.system.nodes}}</span>
      <span class="footer-dot">â—</span>
      <span>UPT: {{c.data.system.uptime}}</span>
    </div>
    <div class="footer-right">
      <span class="footer-muted">SERVICENOW_INTEGRATION</span>
    </div>
  </footer>
  
  <!-- åŠ è½½è¦†ç›–å±‚ -->
  <div class="loading-overlay" ng-if="c.loading">
    <div class="loading-spinner"></div>
    <div class="loading-text">INITIALIZING_SYSTEM...</div>
  </div>
  
</div>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>5d047ae283aaf210f6b1fb96feaad36f</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-23 07:09:26</sys_created_on>
        <sys_id>dd047ae283aaf210f6b1fb96feaad371</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-01-23 07:09:26</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
